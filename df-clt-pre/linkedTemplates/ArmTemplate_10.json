{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Nombre de instancia de Data Factory",
			"defaultValue": "df-clt-pre"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/DF_STG_BEG_HIST_FACT_TOTAL_USUARIS')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "STG_BEG_FACT_TOTAL_USUARIS",
								"type": "DatasetReference"
							},
							"name": "STGFactTotalUsuaris"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "STG_BEG_HIST_FACT_TOTAL_USUARIS",
								"type": "DatasetReference"
							},
							"name": "HistFactTotalUsuaris"
						}
					],
					"transformations": [
						{
							"name": "Datas"
						},
						{
							"name": "RenombrarCampos"
						}
					],
					"script": "parameters{\n\tData_Carrega as string\n}\nsource(output(\n\t\tCodi as string,\n\t\tSignificat as string,\n\t\t{10  General intern} as string,\n\t\t{11  Bad Code} as string,\n\t\t{20  General extern} as string,\n\t\t{25  BEG} as string,\n\t\t{30  Personal de la biblioteca} as string,\n\t\t{110  Institució interna} as string,\n\t\t{120  Institució externa} as string,\n\t\t{  Totals  } as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> STGFactTotalUsuaris\nSTGFactTotalUsuaris derive(DATA_INSERCIO = currentDate(),\n\t\tPERIODE = toDate(concat($Data_Carrega, '01'),'yyyyMMdd')) ~> Datas\nDatas select(mapColumn(\n\t\tID_LOCATION = Codi,\n\t\tDESC_BIBLIOTECA = Significat,\n\t\tNUM_GENERAL_INTERN = {10  General intern},\n\t\tNUM_BAD_CODE = {11  Bad Code},\n\t\tNUM_GENERAL_EXTERN = {20  General extern},\n\t\tNUM_BEG = {25  BEG},\n\t\tNUM_PERSONAL_DE_LA_BIBLIOTECA = {30  Personal de la biblioteca},\n\t\tNUM_INSTITUCIO_INTERNA = {110  Institució interna},\n\t\tNUM_INSTITUCIO_EXTERNA = {120  Institució externa},\n\t\tNUM_TOTALS = {  Totals  },\n\t\tDATA_INSERCIO,\n\t\tDATA_PERIODE = PERIODE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> RenombrarCampos\nRenombrarCampos sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> HistFactTotalUsuaris"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DF_STG_BEG_HIST_FACT_TRANSACCIONS')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "STG_BEG_FACT_TRANSACCIONS",
								"type": "DatasetReference"
							},
							"name": "STGFactTransaccions"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "STG_BEG_HIST_FACT_TRANSACCIONS",
								"type": "DatasetReference"
							},
							"name": "STGHistTransaccions"
						}
					],
					"transformations": [
						{
							"name": "Datas"
						},
						{
							"name": "RenombraCampos"
						}
					],
					"script": "parameters{\n\tData_Carrega as string\n}\nsource(output(\n\t\t{Grup estadístic} as string,\n\t\t{préstecs} as string,\n\t\tretorns as string,\n\t\trenovacions as string,\n\t\treserves as string,\n\t\t{Hl/RECLL} as string,\n\t\t{TOTAL #} as string,\n\t\tPERCENT as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> STGFactTransaccions\nSTGFactTransaccions derive(DATA_INSERCIO = currentDate(),\n\t\tPERIODE = toDate(concat($Data_Carrega, '01'),'yyyyMMdd')) ~> Datas\nDatas select(mapColumn(\n\t\tID_TERMINAL = {Grup estadístic},\n\t\tNUM_PRESTECS = {préstecs},\n\t\tNUM_RETORNS = retorns,\n\t\tNUM_RENOVACIONS = renovacions,\n\t\tNUM_RESERVES = reserves,\n\t\tNUM_HI_RECLL = {Hl/RECLL},\n\t\tNUM_TOTAL = {TOTAL #},\n\t\tNUM_PERCENT = PERCENT,\n\t\tDATA_INSERCIO,\n\t\tDATA_PERIODE = PERIODE\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> RenombraCampos\nRenombraCampos sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> STGHistTransaccions"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_BAIXES_DM')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DF_DM_BAIXES",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_DM_BAIXES",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"ODSFactIndicadors": {},
									"DMFactIndicadors": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX BAIXES/DM"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_BAIXES_ODS1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ODS1_BEG_TOTAL_EXEMPLARS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_TOTAL_EXEMPLARS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalExemplars": {},
									"DimBiblioteques": {},
									"ODS1FactTotalExemplars": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_TOTAL_BIBLIOGRAFICS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ODS1_BEG_TOTAL_EXEMPLARS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_TOTAL_BIBLIOGRAFICS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesBibliografics": {},
									"DimLocations": {},
									"DimBiblioteques": {},
									"ODS1FactTotalBibliografics": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_TOTAL_USUARIS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_TOTAL_USUARIS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalUsuaris": {},
									"DimLocations": {},
									"DimBiblioteques": {},
									"ODS1FactTotalUsuaris": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_ALTES_EXEMPLARS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ODS1_BEG_TOTAL_USUARIS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_ALTES_EXEMPLARS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesExemplars": {},
									"DimBiblioteques": {},
									"ODS1FactAltesExemplars": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_ALTES_BIBLIOGRAFICS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_ALTES_BIBLIOGRAFICS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesBibliografics": {},
									"DimLocations": {},
									"DMDimBiblioteques": {},
									"ODS1FactAltesBibliografics": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_ALTES_USUARIS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ODS1_BEG_ALTES_BIBLIOGRAFICS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_ALTES_USUARIS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesUsuaris": {},
									"DimLocations": {},
									"DMDimBiblioteques": {},
									"ODS1FactAltesUsuaris": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX BAIXES/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_BAIXES_ODS2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ODS2_BEG_FACT_INDICADORS_BASE",
						"description": "Juntar todos los indicadores base en una sola tabla.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS2_BEG_BAIXES",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"ODS1FactTotalBibliografics": {},
									"ODS1FactTotalUsuaris": {},
									"ODS1FactTotalExemplars": {},
									"ODS1FactAltesBibliografics": {},
									"ODS1FactAltesUsuaris": {},
									"ODS1FactAltesExemplars": {},
									"ODS2FactIndicadorsBase": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX BAIXES/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_BAIXES_ODS3')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ODS3_BEG_BAIXES",
						"description": "Creamos todos los indicadores a partir de los base.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS3_BEG_BAIXES",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"ODS2FactIndicadorsBase": {},
									"FactIndicadors": {},
									"ODS3FactIndicadors": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX BAIXES/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:19Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_BAIXES_ODS4')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DF_ODS_BEG_FACT_INDICADORS",
						"description": "Une los indicadores de ficheros con los de data entry para obtener la tabla final.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_ODS4_BAIXES",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"ODS3FactIndicadors": {},
									"DimBiblioteques": {},
									"ODSFactIndicadors": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX BAIXES/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_BAIXES_STG_HIST')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DF_STG_BEG_HIST_FACT_TOTAL_EXEMPLARS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_TOTAL_EXEMPLARS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_FACT_HIST_TOTAL_EXEMPLARS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalExemplars": {},
									"HistFactTotalExemplars": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_TOTAL_EXEMPLARS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_TOTAL_EXEMPLARS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_TOTAL_BIBLIOGRAFICS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_TOTAL_BIBLIOGRAFICS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_TOTAL_BIBLIOGRAFICS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalBibliografics": {},
									"HistFactTotalBibliografics": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_TOTAL_USUARIS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_TOTAL_USUARIS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_TOTAL_USUARIS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalUsuaris": {},
									"HistFactTotalUsuaris": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_TOTAL_USUARIS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_TOTAL_USUARIS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_TOTAL_BIBLIOGRAFICS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_TOTAL_BIBLIOGRAFICS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX BAIXES/STG"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:20Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/DF_STG_BEG_HIST_FACT_TOTAL_USUARIS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_CREA_DATA_ENTRY')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CARREGA_NO_PERIODICS",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_CARREGA_NO_PERIODICS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMFactIndicadors": {},
									"DMDimIndicadors": {},
									"DMDimBibliotecas": {},
									"DMDataEntry": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string",
						"defaultValue": "202112"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX DATA ENTRY"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:19Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_DATA_ENTRY')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CARREGA_DATA_ENTRY",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_CARREGA_DATA_ENTRY",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DataEntry": {},
									"DMDimBiblioteques": {},
									"DMFactIndicadors": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string",
						"defaultValue": "202112"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX DATA ENTRY"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_DIM_BIBLIOTEQUES')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DIBICA_A_BIBLIOTEQUES_BEG",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_DIBICA_A_BIBLIOTEQUES_BEG",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"DimDIBICA": {},
									"DimBiblioteques": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX BIBLIOTEQUES"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:19Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_DM_INTER')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DF_BEG_DM_INTER_IND_10_3",
						"description": "IND_10_3: Assistents a activitats per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_10_3\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_10_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_11_61",
						"description": "IND_11_61: Despeses [de funcionament] per habitant",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": {
										"value": "'@{'IND_11_61'}'",
										"type": "Expression"
									},
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": {
										"value": "[['IND_11']",
										"type": "Expression"
									},
									"P_IND_ORIGEN_DENOMINADOR": {
										"value": "[['IND_6_4']",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_11_62",
						"description": "IND_11_62: Despeses [de funcionament] per visita",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": {
										"value": "'@{'IND_11_62'}'",
										"type": "Expression"
									},
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": {
										"value": "[['IND_11']",
										"type": "Expression"
									},
									"P_IND_ORIGEN_DENOMINADOR": {
										"value": "[['IND_9_1']",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_11_63",
						"description": "IND_11_63: Despeses [de funcionament] per dia de servei",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": {
										"value": "'@{'IND_11_63'}'",
										"type": "Expression"
									},
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": {
										"value": "[['IND_11']",
										"type": "Expression"
									},
									"P_IND_ORIGEN_DENOMINADOR": {
										"value": "[['IND_1_4']",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_11_64",
						"description": "IND_11_64: Despeses [de funcionament] per préstec",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": {
										"value": "'@{'IND_11_64'}'",
										"type": "Expression"
									},
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": {
										"value": "[['IND_11']",
										"type": "Expression"
									},
									"P_IND_ORIGEN_DENOMINADOR": {
										"value": "[['IND_7_4']",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_11_65",
						"description": "IND_11_65: Despeses [de funcionament] per m2",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": {
										"value": "'@{'IND_11_65'}'",
										"type": "Expression"
									},
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": {
										"value": "[['IND_11']",
										"type": "Expression"
									},
									"P_IND_ORIGEN_DENOMINADOR": {
										"value": "[['IND_5_2']",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_5_10",
						"description": "IND_5_10: Superfície útil (m2) per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_5_10\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_5_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_5_011",
						"description": "IND_5_011: Llocs de consulta per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_5_011\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_5_3"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_5_012",
						"description": "IND_5_012: Ordinadors d us públic (exclusiu) per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_5_012\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_5_42"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_2_7",
						"description": "IND_2_7: Jornades per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_2_7\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_2_6"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_8_4",
						"description": "IND_8_4: Documents rebuts per préstec interbibliotecari per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_8_4\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_8_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_4_4",
						"description": "IND_4_4: Publ. periòdiques (títols) per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_4_4\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_4_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_027",
						"description": "IND_9_027: Visites per habitant",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_9_027\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_028",
						"description": "IND_9_028: Visites per dia de servei",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_9_028\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_1_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_030",
						"description": "IND_9_030: Visites en línia per habitant",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_9_029\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_031",
						"description": "IND_9_031: Usuaris d´internet i ofimàtica (sessions) per habitant",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_9_031\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_0223"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_032",
						"description": "IND_9_032: Usuaris d´internet i ofimàtica (sessions) per dia de servei",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_9_032\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_0223"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_1_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_033",
						"description": "IND_9_033: Usuaris d´internet i ofimàtica (sessions) per visita",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_9_033\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_0223"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_9_2"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_6_5",
						"description": "IND_6_5: % de carnets sobre població total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_6_5\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_6_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_41",
						"description": "IND_12_41: Documents per habitant",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_12_41\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_3_8"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_42",
						"description": "IND_12_42: % materials electrònics (no e-books) sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_12_42\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_117",
										"IND_12_127"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_43",
						"description": "IND_12_43: % manuscrits sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_12_43\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_124"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_44",
						"description": "IND_12_44: % cartogràfics sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_12_44\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_118",
										"IND_12_128"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_45",
						"description": "IND_12_45: % gràfics sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_12_45\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_119",
										"IND_12_129"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_46",
						"description": "IND_12_46: % música impresa sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_12_46\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_1110",
										"IND_12_1210"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_47",
						"description": "IND_12_47: % microformes sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_12_47\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_12011"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_48",
						"description": "IND_12_48: Altes de fons per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_12_48\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_49",
						"description": "IND_12_49: % d´altes sobre el fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_12_49\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_12_1"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_410",
						"description": "IND_12_410: % de baixes sobre el fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_12_410\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_3"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_12_1"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_INTRA_ANY_ANT",
						"description": "En este en concreto se calculan los indicadores IND_12_4011, IND_12_4012 y IND_6_6",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA_ANY_ANT",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_CIEN_MIL": "100"
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadorsANT": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_INTRA_IND_9_029",
						"description": "IND_9_029: Visites al dia per m2",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA_IND_9_029",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_9_029\"",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_1_4"
									],
									"P_IND_ORIGEN_DENOMINADOR2": [
										"IND_5_2"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_7_61",
						"description": "IND_7_61: Préstecs per habitant\nNO ESTA VALIDADO. CLIENTE NO LOS QUIERE.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_7_61\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_7_4"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_7_62",
						"description": "IND_7_62: % de péstecs en relació amb el fons prestable total\nNO ESTA VALIDADO. CLIENTE NO LOS QUIERE.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_7_62\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_7_4"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_12_11"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_7_63",
						"description": "IND_7_63: Usuaris actius de préstec per habitant\nNO ESTA VALIDADO. CLIENTE NO LOS QUIERE.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "1",
									"P_NOM_IND_CALC": "\"IND_7_63\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_7_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"P_DATA_INI": {
						"type": "int",
						"defaultValue": 20220301
					},
					"P_DATA_FI": {
						"type": "int",
						"defaultValue": 20220331
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX INTER INTRA"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_DM_INTRA')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DF_BEG_DM_INTER_IND_10_3",
						"description": "IND_10_3: Assistents a activitats per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_10_3\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_10_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_11_61",
						"description": "IND_11_61: Despeses [de funcionament] per habitant",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": {
										"value": "'@{'IND_11_61'}'",
										"type": "Expression"
									},
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": {
										"value": "[['IND_11']",
										"type": "Expression"
									},
									"P_IND_ORIGEN_DENOMINADOR": {
										"value": "[['IND_6_4']",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_11_62",
						"description": "IND_11_62: Despeses [de funcionament] per visita",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": {
										"value": "'@{'IND_11_62'}'",
										"type": "Expression"
									},
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": {
										"value": "[['IND_11']",
										"type": "Expression"
									},
									"P_IND_ORIGEN_DENOMINADOR": {
										"value": "[['IND_9_1']",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_11_63",
						"description": "IND_11_63: Despeses [de funcionament] per dia de servei",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": {
										"value": "'@{'IND_11_63'}'",
										"type": "Expression"
									},
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": {
										"value": "[['IND_11']",
										"type": "Expression"
									},
									"P_IND_ORIGEN_DENOMINADOR": {
										"value": "[['IND_1_4']",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_11_64",
						"description": "IND_11_64: Despeses [de funcionament] per préstec",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": {
										"value": "'@{'IND_11_64'}'",
										"type": "Expression"
									},
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": {
										"value": "[['IND_11']",
										"type": "Expression"
									},
									"P_IND_ORIGEN_DENOMINADOR": {
										"value": "[['IND_7_4']",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_11_65",
						"description": "IND_11_65: Despeses [de funcionament] per m2",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": {
										"value": "'@{'IND_11_65'}'",
										"type": "Expression"
									},
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": {
										"value": "[['IND_11']",
										"type": "Expression"
									},
									"P_IND_ORIGEN_DENOMINADOR": {
										"value": "[['IND_5_2']",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_5_10",
						"description": "IND_5_10: Superfície útil (m2) per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_5_10\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_5_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_5_011",
						"description": "IND_5_011: Llocs de consulta per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_5_011\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_5_3"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_5_012",
						"description": "IND_5_012: Ordinadors d us públic (exclusiu) per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_5_012\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_5_42"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_2_7",
						"description": "IND_2_7: Jornades per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_2_7\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_2_6"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_8_4",
						"description": "IND_8_4: Documents rebuts per préstec interbibliotecari per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_8_4\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_8_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_4_4",
						"description": "IND_4_4: Publ. periòdiques (títols) per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_4_4\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_4_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_027",
						"description": "IND_9_027: Visites per habitant",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_9_027\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_028",
						"description": "IND_9_028: Visites per dia de servei",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_9_028\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_1_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_030",
						"description": "IND_9_030: Visites en línia per habitant",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_9_029\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_031",
						"description": "IND_9_031: Usuaris d´internet i ofimàtica (sessions) per habitant",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_9_031\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_0223"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_032",
						"description": "IND_9_032: Usuaris d´internet i ofimàtica (sessions) per dia de servei",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_9_032\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_0223"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_1_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_9_033",
						"description": "IND_9_033: Usuaris d´internet i ofimàtica (sessions) per visita",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_9_033\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_0223"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_9_2"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_6_5",
						"description": "IND_6_5: % de carnets sobre població total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_6_5\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_6_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_41",
						"description": "IND_12_41: Documents per habitant",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_12_41\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_3_8"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_42",
						"description": "IND_12_42: % materials electrònics (no e-books) sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_12_42\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_117",
										"IND_12_127"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_43",
						"description": "IND_12_43: % manuscrits sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_12_43\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_124"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_44",
						"description": "IND_12_44: % cartogràfics sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_12_44\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_118",
										"IND_12_128"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_45",
						"description": "IND_12_45: % gràfics sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_12_45\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_119",
										"IND_12_129"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_46",
						"description": "IND_12_46: % música impresa sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_12_46\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_1110",
										"IND_12_1210"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_47",
						"description": "IND_12_47: % microformes sobre fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_12_47\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_12011"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_3_8"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_48",
						"description": "IND_12_48: Altes de fons per 1.000 habitants",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_12_48\"",
									"P_CIEN_MIL": "1000",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_49",
						"description": "IND_12_49: % d´altes sobre el fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_12_49\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_2"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_12_1"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_12_410",
						"description": "IND_12_410: % de baixes sobre el fons total",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_12_410\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_12_3"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_12_1"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_INTRA_ANY_ANT",
						"description": "En este en concreto se calculan los indicadores IND_12_4011, IND_12_4012 y IND_6_6",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA_ANY_ANT",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_CIEN_MIL": "100"
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadorsANT": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_INTRA_IND_9_029",
						"description": "IND_9_029: Visites al dia per m2",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA_IND_9_029",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_9_029\"",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_9_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_1_4"
									],
									"P_IND_ORIGEN_DENOMINADOR2": [
										"IND_5_2"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_7_61",
						"description": "IND_7_61: Préstecs per habitant\nNO ESTA VALIDADO. CLIENTE NO LOS QUIERE.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_7_61\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_7_4"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_7_62",
						"description": "IND_7_62: % de péstecs en relació amb el fons prestable total\nNO ESTA VALIDADO. CLIENTE NO LOS QUIERE.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_7_62\"",
									"P_CIEN_MIL": "100",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_7_4"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_12_11"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_BEG_DM_INTER_IND_7_63",
						"description": "IND_7_63: Usuaris actius de préstec per habitant\nNO ESTA VALIDADO. CLIENTE NO LOS QUIERE.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_BEG_DM_INTER_INTRA",
								"type": "DataFlowReference",
								"parameters": {
									"P_DATA_INI": {
										"value": "@pipeline().parameters.P_DATA_INI",
										"type": "Expression"
									},
									"P_DATA_FI": {
										"value": "@pipeline().parameters.P_DATA_FI",
										"type": "Expression"
									},
									"P_FLAG_INTER": "0",
									"P_NOM_IND_CALC": "\"IND_7_63\"",
									"P_CIEN_MIL": "1",
									"P_IND_ORIGEN_NUMERADOR": [
										"IND_7_1"
									],
									"P_IND_ORIGEN_DENOMINADOR": [
										"IND_6_4"
									]
								},
								"datasetParameters": {
									"DMbegFACTindicadors": {},
									"DMbegDIMbiblioteques": {},
									"DMterDIMcomarca": {},
									"DMterDIMmunicipi": {},
									"DMbegFACTindicadors2": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"P_DATA_INI": {
						"type": "int",
						"defaultValue": 20220301
					},
					"P_DATA_FI": {
						"type": "int",
						"defaultValue": 20220331
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX INTER INTRA"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_FACT_DM')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DM_BEG_FACT_INDICADORS",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_DM_BEG_FACT_INDICADOR",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"ODSFactIndicadors": {},
									"PrestecsAnuals": {},
									"DMFactIndicadors": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "UPDATE_ULTIM_MES_CARREGAT",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "DM_BEG_FACT_INDICADORS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[UPDATE_ULTIM_MES_CARREGAT]",
							"storedProcedureParameters": {
								"datacarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string",
						"defaultValue": "202109"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX FITXERS/DM"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_FACT_ODS1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ODS1_BEG_ALTES_EXEMPLARS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_ALTES_EXEMPLARS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesExemplars": {},
									"DimBiblioteques": {},
									"ODS1FactAltesExemplars": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_TOTAL_EXEMPLARS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ODS1_BEG_ALTES_EXEMPLARS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_TOTAL_EXEMPLARS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalExemplars": {},
									"DimBiblioteques": {},
									"ODS1FactTotalExemplars": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_ALTES_BIBLIOGRAFICS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_ALTES_BIBLIOGRAFICS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesBibliografics": {},
									"DimLocations": {},
									"DMDimBiblioteques": {},
									"ODS1FactAltesBibliografics": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_TOTAL_BIBLIOGRAFICS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ODS1_BEG_ALTES_BIBLIOGRAFICS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_TOTAL_BIBLIOGRAFICS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesBibliografics": {},
									"DimLocations": {},
									"DimBiblioteques": {},
									"ODS1FactTotalBibliografics": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_ALTES_USUARIS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_ALTES_USUARIS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesUsuaris": {},
									"DimLocations": {},
									"DMDimBiblioteques": {},
									"ODS1FactAltesUsuaris": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_TOTAL_USUARIS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ODS1_BEG_ALTES_USUARIS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_TOTAL_USUARIS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalUsuaris": {},
									"DimLocations": {},
									"DimBiblioteques": {},
									"ODS1FactTotalUsuaris": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_TOTAL_HOLDINGS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_TOTAL_HOLDINGS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalHoldings": {},
									"DMDimLocations": {},
									"ODSFactTotalHoldings": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_ALTES_HOLDINGS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ODS1_BEG_TOTAL_HOLDINGS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_ALTES_HOLDINGS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalHoldings": {},
									"DMDimLocations": {},
									"DMDimBiblioteques": {},
									"ODSFactTotalHoldings": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS1_BEG_TRANSACCIONS",
						"description": "Calcular indicadores base",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS1_BEG_FACT_TRANSACCIONS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTransaccions": {},
									"DimTerminals": {},
									"DMDimBiblioteques": {},
									"ODS1FactTransaccions": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS_BEG_FACT_PRESTEC_CONSULTA1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  biblios.ID_AGENCY as id_biblioteca,\n\t[BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].codi_indicador,\n\tcount(*) as valor\nFROM (\nselect DISTINCT [OUT LOC], taula.[RECORD #(PATRON)], taula.[P TYPE] \n\t\tfrom [BEG_STG].[STG_BEG_FACT_PRESTECS] taula \n\t ) taula_aux\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR] \n\t\tON taula_aux.[P TYPE] = [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].[P_TYPE] and [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].DESC_CONSULTA = 'BEG_CONSULTA_01'\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_TERMINALS] term\n\t\tON taula_aux.[OUT LOC] = term.ID_TERMINAL\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] biblios  \n\t\tON biblios.CODI_BIBLIOTECA = term.CODI_BIBLIOTECA\ngroup by biblios.ID_AGENCY, [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].codi_indicador",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [BEG_ODS].[ODS_BEG_FACT_PRESTEC_CONSULTA1]",
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "STG_BEG_FACT_PRESTECS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ODS_BEG_FACT_PRESTEC_CONSULTA1",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ODS_BEG_FACT_PRESTEC_CONSULTA3",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT biblios.ID_AGENCY as id_biblioteca,\n\t[BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].codi_indicador,\n\tcount(*) as valor\nfrom [BEG_STG].[STG_BEG_FACT_PRESTECS] taula \n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR] \n\t\tON taula.[P TYPE] = [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].P_TYPE and [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].DESC_CONSULTA = 'BEG_CONSULTA_03'\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_TERMINALS] term\n\t\tON taula.[OUT LOC] = term.ID_TERMINAL\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] biblios  \n\t\tON biblios.CODI_BIBLIOTECA = term.CODI_BIBLIOTECA\ngroup by biblios.ID_AGENCY, [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].codi_indicador",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [BEG_ODS].[ODS_BEG_FACT_PRESTEC_CONSULTA3]",
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "STG_BEG_FACT_PRESTECS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ODS_BEG_FACT_PRESTEC_CONSULTA3",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ODS_BEG_FACT_PRESTEC_CONSULTA4",
						"description": "",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select biblios.ID_AGENCY as id_biblioteca,\n\t[BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].codi_indicador,\n\tcount(*) as valor\nfrom [BEG_STG].[STG_BEG_FACT_PRESTECS] taula \n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR] \n\t\tON taula.[I TYPE] = [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].P_TYPE and [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].DESC_CONSULTA = 'BEG_CONSULTA_04'\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_TERMINALS] term\n\t\tON taula.[OUT LOC] = term.ID_TERMINAL\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] biblios  \n\t\tON biblios.CODI_BIBLIOTECA = term.CODI_BIBLIOTECA\ngroup by biblios.ID_AGENCY, [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].codi_indicador\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [BEG_ODS].[ODS_BEG_FACT_PRESTEC_CONSULTA4]",
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "STG_BEG_FACT_PRESTECS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ODS_BEG_FACT_PRESTEC_CONSULTA4",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ODS_BEG_FACT_PRESTEC_CONSULTA5",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select biblios.ID_AGENCY as id_biblioteca,\n\t[BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].codi_indicador,\n\tcount(*) as valor\nfrom [BEG_STG].[STG_BEG_FACT_PRESTECS] taula\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR] \n\t\tON taula.[I TYPE] = [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].p_type and [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].desc_consulta = 'BEG_CONSULTA_05'\n\tINNER JOIN (SELECT * FROM [BEG_DM].[DM_BEG_DIM_TERMINALS]\n\t\tWHERE FLAG_AUTOPRESTEC = 1) term\n\t\t\tON taula.[OUT LOC] = term.ID_TERMINAL\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] biblios  \n\t\tON biblios.CODI_BIBLIOTECA = term.CODI_BIBLIOTECA\ngroup by biblios.ID_AGENCY, [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].codi_indicador",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [BEG_ODS].[ODS_BEG_FACT_PRESTEC_CONSULTA5]",
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "STG_BEG_FACT_PRESTECS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ODS_BEG_FACT_PRESTEC_CONSULTA5",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "DF_ODS_BEG_FACT_INDICADORS_PRESTECS",
						"description": "Juntar todos los indicadores base de prestecs",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ODS_BEG_FACT_PRESTEC_CONSULTA5",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ODS_BEG_FACT_PRESTEC_CONSULTA4",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ODS_BEG_FACT_PRESTEC_CONSULTA3",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ODS_BEG_FACT_PRESTEC_CONSULTA1",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ODS_BEG_FACT_PRESTEC_CONSUTLA7",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ODS_BEG_FACT_PRESTEC_CONSULTA9",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ODS_BEG_FACT_PRESTEC_CONSULTA8",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "ODS_BEG_FACT_PRESTEC_CONSULTA10",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS_BEG_FACT_INDICADORS_PRESTECS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"ODSFactConsulta1": {},
									"ODSFactConsulta3": {},
									"ODSFactConsulta4": {},
									"ODSFactConsulta5": {},
									"ODSFactConsulta7": {},
									"ODSFactConsulta8": {},
									"ODSFactConsulta9": {},
									"ODSFactConsulta10": {},
									"DIMBiblio": {},
									"DimIndicador": {},
									"ODSFactIndicadorsPrestecs": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "ODS_BEG_FACT_PRESTEC_CONSUTLA7",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select biblios.ID_AGENCY as id_biblioteca,\n\t'IND_8_1311' as codi_indicador,\n\tcount(*) as valor\nfrom [BEG_STG].[STG_BEG_FACT_PRESTECS] taula \n\tINNER JOIN (select ID_AGENCY, ID_LOCATION from [BEG_DM].[DM_BEG_DIM_LOCATIONS] loc\ninner join [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] bib\n\ton bib.CODI_BIBLIOTECA = loc.CODI_BIBLIOTECA) biblios  ON biblios.ID_AGENCY = taula.AGENCY \n\tinner join (select ID_TERMINAL, ID_LOCATION from [BEG_DM].[DM_BEG_DIM_TERMINALS] ter\ninner join [BEG_DM].[DM_BEG_DIM_LOCATIONS] loc2 on ter.CODI_BIBLIOTECA = loc2.CODI_BIBLIOTECA) biblios2 on biblios2.ID_TERMINAL = taula.[OUT LOC] \nwhere biblios.ID_LOCATION <> biblios2.ID_LOCATION \n\tand\tbiblios2.ID_LOCATION = taula.LOCATION \n\tand biblios.ID_LOCATION <> taula.LOCATION\ngroup by biblios.ID_AGENCY",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [BEG_ODS].[ODS_BEG_FACT_PRESTEC_CONSULTA7]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "STG_BEG_FACT_PRESTECS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ODS_BEG_FACT_PRESTEC_CONSULTA7",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ODS_BEG_FACT_PRESTEC_CONSULTA8",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select biblios.ID_AGENCY as id_biblioteca,\n\t'IND_8_1312' as codi_indicador,\n\tcount(*) as valor\nfrom [BEG_STG].[STG_BEG_FACT_PRESTECS] taula \n\tINNER JOIN (select ID_AGENCY, ID_LOCATION from [BEG_DM].[DM_BEG_DIM_LOCATIONS] loc\ninner join [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] bib\n\ton bib.CODI_BIBLIOTECA = loc.CODI_BIBLIOTECA) biblios  ON biblios.ID_AGENCY = taula.AGENCY \n\tinner join (select ID_TERMINAL, ID_LOCATION from [BEG_DM].[DM_BEG_DIM_TERMINALS] ter\ninner join [BEG_DM].[DM_BEG_DIM_LOCATIONS] loc2 on ter.CODI_BIBLIOTECA = loc2.CODI_BIBLIOTECA) biblios2 on biblios2.ID_TERMINAL = taula.[OUT LOC]\nwhere biblios.ID_LOCATION <> biblios2.ID_LOCATION \n\tand\tbiblios2.ID_LOCATION <> taula.LOCATION \n\tand biblios.ID_LOCATION = taula.location\ngroup by biblios.ID_AGENCY",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [BEG_ODS].[ODS_BEG_FACT_PRESTEC_CONSULTA8]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "STG_BEG_FACT_PRESTECS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ODS_BEG_FACT_PRESTEC_CONSULTA8",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ODS_BEG_FACT_PRESTEC_CONSULTA9",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select biblios2.ID_AGENCY as id_biblioteca,\n\t'IND_8_2311' as codi_indicador,\n\tcount(*) as valor\nfrom [BEG_STG].[STG_BEG_FACT_PRESTECS] taula \n\tINNER JOIN (select ID_AGENCY, ID_LOCATION from [BEG_DM].[DM_BEG_DIM_LOCATIONS] loc\ninner join [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] bib\n\ton bib.CODI_BIBLIOTECA = loc.CODI_BIBLIOTECA) biblios  ON biblios.ID_AGENCY = taula.AGENCY \n\tinner join (select ID_AGENCY, ID_TERMINAL, ID_LOCATION from [BEG_DM].[DM_BEG_DIM_TERMINALS] ter\ninner join [BEG_DM].[DM_BEG_DIM_LOCATIONS] loc2 on ter.CODI_BIBLIOTECA = loc2.CODI_BIBLIOTECA\nINNER JOIN [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] b ON b.CODI_BIBLIOTECA = ter.CODI_BIBLIOTECA\n\t) biblios2 on biblios2.ID_TERMINAL = taula.[OUT LOC]\nwhere biblios.ID_LOCATION <> biblios2.ID_LOCATION\n\tand\tbiblios2.ID_LOCATION = taula.LOCATION\n\tand biblios.ID_LOCATION <> taula.location\ngroup by biblios2.ID_AGENCY\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [BEG_ODS].[ODS_BEG_FACT_PRESTEC_CONSULTA9]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "STG_BEG_FACT_PRESTECS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ODS_BEG_FACT_PRESTEC_CONSULTA9",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ODS_BEG_FACT_PRESTEC_CONSULTA10",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select biblios2.ID_AGENCY as id_biblioteca,\n\t'IND_8_2312' as codi_indicador,\n\tcount(*) as valor\nfrom [BEG_STG].[STG_BEG_FACT_PRESTECS] taula \n\tINNER JOIN (select ID_AGENCY, ID_LOCATION from [BEG_DM].[DM_BEG_DIM_LOCATIONS] loc\ninner join [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] bib\n\ton bib.CODI_BIBLIOTECA = loc.CODI_BIBLIOTECA) biblios  ON biblios.ID_AGENCY = taula.AGENCY \n\tinner join (select ID_AGENCY, ID_TERMINAL, ID_LOCATION from [BEG_DM].[DM_BEG_DIM_TERMINALS] ter\ninner join [BEG_DM].[DM_BEG_DIM_LOCATIONS] loc2 on ter.CODI_BIBLIOTECA = loc2.CODI_BIBLIOTECA\nINNER JOIN [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] b ON b.CODI_BIBLIOTECA = ter.CODI_BIBLIOTECA\n\t) biblios2 on biblios2.ID_TERMINAL = taula.[OUT LOC]\nwhere biblios.ID_LOCATION <> biblios2.ID_LOCATION \n\tand\tbiblios2.ID_LOCATION <> taula.LOCATION \n\tand biblios.ID_LOCATION = taula.location\ngroup by biblios2.ID_AGENCY",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table [BEG_ODS].[ODS_BEG_FACT_PRESTEC_CONSULTA10]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "STG_BEG_FACT_PRESTECS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ODS_BEG_FACT_PRESTEC_CONSULTA10",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CARREGA_PROCEDENCIA",
						"type": "IfCondition",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(substring(pipeline().parameters.Data_Carrega,4,2),'12')",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "ODS_PROCEDENCIA",
									"type": "ExecuteDataFlow",
									"dependsOn": [],
									"policy": {
										"timeout": "1.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataflow": {
											"referenceName": "DF_ODS1_BEG_FACT_PROCEDENCIA",
											"type": "DataFlowReference",
											"parameters": {
												"Data_Carrega": {
													"value": "'@{pipeline().parameters.Data_Carrega}'",
													"type": "Expression"
												}
											},
											"datasetParameters": {
												"STGProcedencia": {},
												"DimBiblioteques": {},
												"sink1": {}
											}
										},
										"staging": {},
										"integrationRuntime": {
											"referenceName": "IntegrationRuntimeAzure",
											"type": "IntegrationRuntimeReference"
										},
										"traceLevel": "Fine"
									}
								}
							]
						}
					},
					{
						"name": "ODS_BEG_FACT_PRESTEC_CONSULTA2",
						"description": "Calcula mediante la query los prestamos anuales por biblioteca",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "DF_ODS_BEG_FACT_INDICADORS_PRESTECS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": {
									"value": "@concat('SELECT  biblios.ID_AGENCY as id_biblioteca,\n\t[BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].codi_indicador,\n\tcount(*) as valor, \n\tCONVERT(date, ''',string(add(int(substring(pipeline().parameters.Data_Carrega,0,4)),-1)),''' + ''12'' + ''01'') as data_periode,\n\tconvert(date,getdate()) as data_insercio\nFROM (\nselect DISTINCT ID_OUT_LOC, taula.[CODI_RECORD_PATRON], taula.[NUM_P_TYPE] \n\t\tfrom [BEG_STG].[STG_BEG_HIST_FACT_PRESTECS] taula \n\t\twhere YEAR(DATA_PERIODE) = ',string(add(int(substring(pipeline().parameters.Data_Carrega,0,4)),-1)),'\n\t ) taula_aux\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR] \n\t\tON taula_aux.[NUM_P_TYPE] = [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].[P_TYPE] and [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].DESC_CONSULTA = ''BEG_CONSULTA_02''\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_TERMINALS] term\n\t\tON taula_aux.[ID_OUT_LOC] = term.ID_TERMINAL\n\tINNER JOIN [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] biblios  \n\t\tON biblios.CODI_BIBLIOTECA = term.CODI_BIBLIOTECA\ngroup by biblios.ID_AGENCY, [BEG_DM].[DM_BEG_DIM_REL_P_TYPE_INDICADOR].codi_indicador')",
									"type": "Expression"
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [BEG_ODS].[ODS_BEG_PRESTECS_ANUALS]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "STG_BEG_FACT_PRESTECS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ODS_BEG_PRESTECS_ANUALS",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "FACT_PRESTECS_ANUALS",
						"description": "Mete en la tabla DM_PRESTECS_ANUALS la información de la ODS con ceros en los indicadores que no se hayan calculado.",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "ODS_BEG_FACT_PRESTEC_CONSULTA2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_FACT_PRESTECS_ANUALS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"ODSConsulta2": {},
									"Bibliotecas": {},
									"DimIndicadors": {},
									"DMFactPrestecsAnuals": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string",
						"defaultValue": "202109"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX FITXERS/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_FACT_ODS2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ODS2_BEG_FACT_INDICADORS_BASE",
						"description": "Juntar todos los indicadores base en una sola tabla.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS2_BEG_FACT_INDICADORS_BASE",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"ODS1FactAltesBibliografics": {},
									"ODS1FactAltesUsuaris": {},
									"ODS1FactAltesExemplars": {},
									"ODS1FactTotalBibliografics": {},
									"ODS1FactTotalUsuaris": {},
									"ODS1FactTotalExemplars": {},
									"ODS1FactTotalHoldings": {},
									"ODS1FactAltesHoldings": {},
									"ODS1FactPrestecs": {},
									"ODS1Transaccions": {},
									"DMDimBiblioteques": {},
									"ODS2FactIndicadorsBase": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string",
						"defaultValue": "202112"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX FITXERS/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_FACT_ODS3')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ODS3_BEG_FACT_INDICADORS",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS3_BEG_FACT_INDICADORS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"ODS2FactIndicadors": {},
									"DimBiblioteques": {},
									"DMDimIndicadors": {},
									"ODS3FactIndicadors": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "CARREGA_PROCEDENCIA",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "ODS3_BEG_FACT_INDICADORS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(substring(pipeline().parameters.Data_Carrega,4,2),'12')",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "DF_CARREGA_PROCEDENCIA",
									"type": "ExecuteDataFlow",
									"dependsOn": [],
									"policy": {
										"timeout": "1.00:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"dataflow": {
											"referenceName": "DF_CARREGA_PROCEDENCIA",
											"type": "DataFlowReference",
											"parameters": {},
											"datasetParameters": {
												"Procedencia": {},
												"ODS3FactIndicadorsSink": {}
											}
										},
										"staging": {},
										"integrationRuntime": {
											"referenceName": "IntegrationRuntimeAzure",
											"type": "IntegrationRuntimeReference"
										},
										"traceLevel": "Fine"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string",
						"defaultValue": "202109"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX FITXERS/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:18Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_FACT_ODS4')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ODS4_BEG_FACT_INDICADORS",
						"description": "Creamos todos los indicadores a partir de los base.",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS4_BEG_FACT_INDICADORS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"ODS3FactIndicadorsBase": {},
									"FactIndicadors": {},
									"ODS4FactIndicadors": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string",
						"defaultValue": "202112"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX FITXERS/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_FACT_ODS5')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DF_ODS_BEG_FACT_INDICADORS",
						"description": "",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "HORES_DOBERTURA",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_ODS_BEG_FACT_INDICADORS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"ODS4FactIndicadors": {},
									"DimBiblioteques": {},
									"HoresDObertura": {},
									"ODSFactIndicadors": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "HORES_DOBERTURA",
						"description": "Calcula el IND_1_3",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "select b.CODI_BIBLIOTECA,'IND_1_3' as CODI_INDICADOR,\n(coalesce(datediff(MINUTE,cast(dl_mati_ini as time),cast(isnull(dl_mati_fi,dl_tarda_fi) as time)),0)\n+ coalesce(datediff(MINUTE,cast(dl_tarda_ini as time),cast(dl_tarda_fi as time)),0)\n \n+ coalesce(datediff(MINUTE,cast(dt_mati_ini as time),cast(isnull(dt_mati_fi,dt_tarda_fi) as time)),0) \n+ coalesce(datediff(MINUTE,cast(dt_tarda_ini as time),cast(dt_tarda_fi as time)),0)\n\n+ coalesce(datediff(MINUTE,cast(dc_mati_ini as time),cast(isnull(dc_mati_fi,dc_tarda_fi) as time)),0)\n+ coalesce(datediff(MINUTE,cast(dc_tarda_ini as time),cast(dc_tarda_fi as time)),0)\n\n+ coalesce(datediff(MINUTE,cast(dj_mati_ini as time),cast(isnull(dj_mati_fi,dj_tarda_fi) as time)),0) \n+ coalesce(datediff(MINUTE,cast(dj_tarda_ini as time),cast(dj_tarda_fi as time)),0)\n\n+ coalesce(datediff(MINUTE,cast(dv_mati_ini as time),cast(isnull(dv_mati_fi,dv_tarda_fi) as time)),0) \n+ coalesce(datediff(MINUTE,cast(dv_tarda_ini as time),cast(dv_tarda_fi as time)),0)\n\n+ coalesce(datediff(MINUTE,cast(ds_mati_ini as time),cast(isnull(ds_mati_fi,ds_tarda_fi) as time)),0) \n+ coalesce(datediff(MINUTE,cast(ds_tarda_ini as time),cast(ds_tarda_fi as time)),0)\n\n+ coalesce(datediff(MINUTE,cast(dg_mati_ini as time),cast(isnull(dg_mati_fi,dg_tarda_fi) as time)),0) \n+ coalesce(datediff(MINUTE,cast(dg_tarda_ini as time),cast(dg_tarda_fi as time)),0))\n\n/60.0\n as IND_VALOR\nfrom [DIB_STG].[STG_DIB_DIM_HORARIS_HIVERN] h\njoin [BEG_DM].[DM_BEG_DIM_BIBLIOTEQUES] b on h.id_biblioteca=b.id_biblioteca\n",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "TRUNCATE TABLE [BEG_ODS].[ODS_BEG_HORES_DOBERTURA]",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "DM_BEG_DIM_DIBICA_HORARIS_HIVERN",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "ODS_BEG_HORES_DOBERTURA",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string",
						"defaultValue": "202112"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX FITXERS/ODS"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:23Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/PL_BEG_FACT_STG_HIST')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "DF_STG_BEG_HIST_FACT_TOTAL_EXEMPLARS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_TOTAL_EXEMPLARS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_FACT_HIST_TOTAL_EXEMPLARS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalExemplars": {},
									"HistFactTotalExemplars": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_TOTAL_EXEMPLARS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_TOTAL_EXEMPLARS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_TOTAL_BIBLIOGRAFICS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_TOTAL_BIBLIOGRAFICS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_TOTAL_BIBLIOGRAFICS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalBibliografics": {},
									"HistFactTotalBibliografics": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_TOTAL_USUARIS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_TOTAL_USUARIS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_TOTAL_USUARIS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalUsuaris": {},
									"HistFactTotalUsuaris": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_TOTAL_HOLDINGS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_TOTAL_HOLDINGS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_TOTAL_HOLDINGS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTotalHoldings": {},
									"HISTFactTotalHoldings": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_ALTES_BIBLIOGRAFICS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_ALTES_BIBLIOGRAFICS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_ALTES_BIBLIOGRAFICS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesBibliografics": {},
									"HistFactAltesBibliografics": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_ALTES_USUARIS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_ALTES_USUARIS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_ALTES_USUARIS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesUsuaris": {},
									"HistFactAltesUsuaris": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_ALTES_EXEMPLARS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_ALTES_EXEMPLARS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_ALTES_EXEMPLARS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesExemplars": {},
									"HISTAltesExemplars": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_ALTES_HOLDINGS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_ALTES_HOLDINGS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_ALTES_HOLDINGS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactAltesHoldings": {},
									"HistFactAltesHoldings": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_TOTAL_USUARIS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_TOTAL_USUARIS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_ALTES_HOLDINGS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_ALTES_HOLDINGS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_ALTES_EXEMPLARS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_ALTES_EXEMPLARS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_ALTES_USUARIS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_ALTES_USUARIS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_ALTES_BIBLIOGRAFICS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_ALTES_BIBLIOGRAFICS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_TOTAL_HOLDINGS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_TOTAL_HOLDINGS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_TOTAL_BIBLIOGRAFICS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_TOTAL_BIBLIOGRAFICS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_TRANSACCIONS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_TRANSACCIONS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_TRANSACCIONS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGFactTransaccions": {},
									"STGHistTransaccions": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_TRANSACCIONS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_TRANSACCIONS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_PRESTECS",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_PRESTECS",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_PRESTECS",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_PRESTECS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_PRESTECS",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGPrestecs": {},
									"STGHistFactPrestecs": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					},
					{
						"name": "BORRAR_MES_ACTUAL_PROCEDENCIA",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[DELETE_ROWS_FROM_TABLES]",
							"storedProcedureParameters": {
								"vColumnName": {
									"value": "DATA_PERIODE",
									"type": "String"
								},
								"vDataCarrega": {
									"value": {
										"value": "@pipeline().parameters.Data_Carrega",
										"type": "Expression"
									},
									"type": "String"
								},
								"vSchemaName": {
									"value": "BEG_STG",
									"type": "String"
								},
								"vTableName": {
									"value": "STG_BEG_HIST_FACT_TOTAL_EXEMPLARS_PROCEDENCIA",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "DB_CLT",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "DF_STG_BEG_HIST_FACT_PROCEDENCIA",
						"type": "ExecuteDataFlow",
						"dependsOn": [
							{
								"activity": "BORRAR_MES_ACTUAL_PROCEDENCIA",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "1.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "DF_STG_BEG_HIST_FACT_PROCEDENCIA",
								"type": "DataFlowReference",
								"parameters": {
									"Data_Carrega": {
										"value": "'@{pipeline().parameters.Data_Carrega}'",
										"type": "Expression"
									}
								},
								"datasetParameters": {
									"STGProcedencia": {},
									"STGHistProcedencia": {}
								}
							},
							"staging": {},
							"integrationRuntime": {
								"referenceName": "IntegrationRuntimeAzure",
								"type": "IntegrationRuntimeReference"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"parameters": {
					"Data_Carrega": {
						"type": "string",
						"defaultValue": "202109"
					}
				},
				"folder": {
					"name": "SINTESI BEG/FLUX FITXERS/STG"
				},
				"annotations": [],
				"lastPublishTime": "2023-04-19T09:22:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/dataflows/DF_STG_BEG_HIST_FACT_TOTAL_USUARIS')]",
				"[concat(variables('factoryId'), '/dataflows/DF_STG_BEG_HIST_FACT_TRANSACCIONS')]"
			]
		}
	]
}