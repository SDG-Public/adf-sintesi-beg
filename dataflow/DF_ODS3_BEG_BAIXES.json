{
	"name": "DF_ODS3_BEG_BAIXES",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ODS2_BEG_FACT_INDICADORS_BASE",
						"type": "DatasetReference"
					},
					"name": "ODS2FactIndicadorsBase"
				},
				{
					"dataset": {
						"referenceName": "DM_BEG_FACT_INDICADORS",
						"type": "DatasetReference"
					},
					"name": "FactIndicadors"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ODS3_BEG_FACT_INDICADORS",
						"type": "DatasetReference"
					},
					"name": "ODS3FactIndicadors"
				}
			],
			"transformations": [
				{
					"name": "Pivot"
				},
				{
					"name": "DataInsercio"
				},
				{
					"name": "ColumnasIndBase",
					"description": "Creates an explicit mapping for each drifted column"
				},
				{
					"name": "Unpivot"
				},
				{
					"name": "IndNuevos"
				},
				{
					"name": "IndNuevos2"
				},
				{
					"name": "FiltarFecha"
				},
				{
					"name": "FiltrarIndicadores"
				},
				{
					"name": "IndMesAnterior"
				},
				{
					"name": "Union"
				},
				{
					"name": "IndNuevos3"
				},
				{
					"name": "QuitarIndAnt"
				},
				{
					"name": "FiltroNULLs"
				},
				{
					"name": "FiltroNoNULLs"
				},
				{
					"name": "FiltroNoNULLsANT"
				}
			],
			"script": "parameters{\n\tData_Carrega as string\n}\nsource(output(\n\t\tCODI_BIBLIOTECA as string,\n\t\tCODI_INDICADOR as string,\n\t\tIND_VALOR as integer,\n\t\tDATA_INSERCIO as date,\n\t\tDATA_PERIODE as date\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> ODS2FactIndicadorsBase\nsource(output(\n\t\tID_AGENCY as string,\n\t\tCODI_BIBLIOTECA as string,\n\t\tCODI_INDICADOR as string,\n\t\tIND_VALOR as integer,\n\t\tDATA_INSERCIO as date,\n\t\tDATA_PERIODE as date\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> FactIndicadors\nUnion pivot(groupBy(CODI_BIBLIOTECA),\n\tpivotBy(CODI_INDICADOR),\n\t{} = sum(IND_VALOR),\n\tcolumnNaming: '$N$V',\n\tlateral: true) ~> Pivot\nUnpivot derive(DATA_INSERCIO = currentDate(),\n\t\tDATA_PERIODE = toDate(concat($Data_Carrega,'01'),'yyyyMMdd')) ~> DataInsercio\nPivot derive(IND_12_11012 = toInteger(byName('IND_12_11012')),\n\t\tIND_12_11013 = toInteger(byName('IND_12_11013')),\n\t\tIND_12_1110 = toInteger(byName('IND_12_1110')),\n\t\tIND_12_112 = toInteger(byName('IND_12_112')),\n\t\tIND_12_113 = toInteger(byName('IND_12_113')),\n\t\tIND_12_115 = toInteger(byName('IND_12_115')),\n\t\tIND_12_116 = toInteger(byName('IND_12_116')),\n\t\tIND_12_117 = toInteger(byName('IND_12_117')),\n\t\tIND_12_118 = toInteger(byName('IND_12_118')),\n\t\tIND_12_119 = toInteger(byName('IND_12_119')),\n\t\tIND_12_12011 = toInteger(byName('IND_12_12011')),\n\t\tIND_12_12012 = toInteger(byName('IND_12_12012')),\n\t\tIND_12_121 = toInteger(byName('IND_12_121')),\n\t\tIND_12_1210 = toInteger(byName('IND_12_1210')),\n\t\tIND_12_122 = toInteger(byName('IND_12_122')),\n\t\tIND_12_123 = toInteger(byName('IND_12_123')),\n\t\tIND_12_124 = toInteger(byName('IND_12_124')),\n\t\tIND_12_125 = toInteger(byName('IND_12_125')),\n\t\tIND_12_126 = toInteger(byName('IND_12_126')),\n\t\tIND_12_127 = toInteger(byName('IND_12_127')),\n\t\tIND_12_128 = toInteger(byName('IND_12_128')),\n\t\tIND_12_129 = toInteger(byName('IND_12_129')),\n\t\tIND_12_21013 = toInteger(byName('IND_12_21013')),\n\t\tIND_12_212 = toInteger(byName('IND_12_212')),\n\t\tIND_12_213 = toInteger(byName('IND_12_213')),\n\t\tIND_12_215 = toInteger(byName('IND_12_215')),\n\t\tIND_12_216 = toInteger(byName('IND_12_216')),\n\t\tIND_12_217 = toInteger(byName('IND_12_217')),\n\t\tIND_12_218 = toInteger(byName('IND_12_218')),\n\t\tIND_12_219 = toInteger(byName('IND_12_219')),\n\t\tIND_12_2110 = toInteger(byName('IND_12_2110')),\n\t\tIND_12_21012 = toInteger(byName('IND_12_21012')),\n\t\tIND_12_22012 = toInteger(byName('IND_12_22012')),\n\t\tIND_12_221 = toInteger(byName('IND_12_221')),\n\t\tIND_12_222 = toInteger(byName('IND_12_222')),\n\t\tIND_12_223 = toInteger(byName('IND_12_223')),\n\t\tIND_12_224 = toInteger(byName('IND_12_224')),\n\t\tIND_12_225 = toInteger(byName('IND_12_225')),\n\t\tIND_12_226 = toInteger(byName('IND_12_226')),\n\t\tIND_12_227 = toInteger(byName('IND_12_227')),\n\t\tIND_12_228 = toInteger(byName('IND_12_228')),\n\t\tIND_12_229 = toInteger(byName('IND_12_229')),\n\t\tIND_12_2210 = toInteger(byName('IND_12_2210')),\n\t\tIND_12_22011 = toInteger(byName('IND_12_22011')),\n\t\tIND_3_81 = toInteger(byName('IND_3_81')),\n\t\tIND_3_82 = toInteger(byName('IND_3_82')),\n\t\tIND_3_83 = toInteger(byName('IND_3_83')),\n\t\tIND_3_84 = toInteger(byName('IND_3_84')),\n\t\tIND_3_85 = toInteger(byName('IND_3_85')),\n\t\tIND_3_86 = toInteger(byName('IND_3_86')),\n\t\tIND_3_87 = toInteger(byName('IND_3_87')),\n\t\tIND_3_88 = toInteger(byName('IND_3_88')),\n\t\tIND_3_89 = toInteger(byName('IND_3_89')),\n\t\tIND_3_810 = toInteger(byName('IND_3_810')),\n\t\tIND_3_8011 = toInteger(byName('IND_3_8011')),\n\t\tIND_3_8012 = toInteger(byName('IND_3_8012')),\n\t\tIND_3_8013 = toInteger(byName('IND_3_8013')),\n\t\tIND_3_8014 = toInteger(byName('IND_3_8014')),\n\t\tIND_3_8015 = toInteger(byName('IND_3_8015')),\n\t\tIND_3_91 = toInteger(byName('IND_3_91')),\n\t\tIND_3_92 = toInteger(byName('IND_3_92')),\n\t\tIND_3_93 = toInteger(byName('IND_3_93')),\n\t\tIND_3_94 = toInteger(byName('IND_3_94')),\n\t\tIND_3_95 = toInteger(byName('IND_3_95')),\n\t\tIND_3_96 = toInteger(byName('IND_3_96')),\n\t\tIND_3_97 = toInteger(byName('IND_3_97')),\n\t\tIND_3_98 = toInteger(byName('IND_3_98')),\n\t\tIND_3_99 = toInteger(byName('IND_3_99')),\n\t\tIND_3_910 = toInteger(byName('IND_3_910')),\n\t\tIND_3_9011 = toInteger(byName('IND_3_9011')),\n\t\tIND_3_9012 = toInteger(byName('IND_3_9012')),\n\t\tIND_3_9013 = toInteger(byName('IND_3_9013')),\n\t\tIND_3_9014 = toInteger(byName('IND_3_9014')),\n\t\tIND_3_9015 = toInteger(byName('IND_3_9015')),\n\t\tIND_6_11 = toInteger(byName('IND_6_11')),\n\t\tIND_6_12 = toInteger(byName('IND_6_12')),\n\t\tIND_6_13 = toInteger(byName('IND_6_13')),\n\t\tIND_6_14 = toInteger(byName('IND_6_14')),\n\t\tIND_6_15 = toInteger(byName('IND_6_15')),\n\t\tIND_6_16 = toInteger(byName('IND_6_16')),\n\t\tIND_6_21 = toInteger(byName('IND_6_21')),\n\t\tIND_6_22 = toInteger(byName('IND_6_22')),\n\t\tIND_6_23 = toInteger(byName('IND_6_23')),\n\t\tIND_6_24 = toInteger(byName('IND_6_24')),\n\t\tIND_6_25 = toInteger(byName('IND_6_25')),\n\t\tIND_6_26 = toInteger(byName('IND_6_26')),\n\t\tIND_13_1 = toInteger(byName('IND_13_1')),\n\t\tIND_13_2 = toInteger(byName('IND_13_2')),\n\t\tIND_13_3 = toInteger(byName('IND_13_3')),\n\t\tIND_14_11 = toInteger(byName('IND_14_11')),\n\t\tIND_14_12 = toInteger(byName('IND_14_12')),\n\t\tIND_14_13 = toInteger(byName('IND_14_13')),\n\t\tIND_14_14 = toInteger(byName('IND_14_14')),\n\t\tIND_14_15 = toInteger(byName('IND_14_15')),\n\t\tIND_14_16 = toInteger(byName('IND_14_16')),\n\t\tIND_14_21 = toInteger(byName('IND_14_21')),\n\t\tIND_14_22 = toInteger(byName('IND_14_22')),\n\t\tIND_14_23 = toInteger(byName('IND_14_23')),\n\t\tIND_14_24 = toInteger(byName('IND_14_24')),\n\t\tIND_14_25 = toInteger(byName('IND_14_25')),\n\t\tIND_14_26 = toInteger(byName('IND_14_26')),\n\t\tIND_7_11 = toInteger(byName('IND_7_11')),\n\t\tIND_7_12 = toInteger(byName('IND_7_12')),\n\t\tIND_7_13 = toInteger(byName('IND_7_13')),\n\t\tIND_7_14 = toInteger(byName('IND_7_14')),\n\t\tIND_7_15 = toInteger(byName('IND_7_15')),\n\t\tIND_7_16 = toInteger(byName('IND_7_16')),\n\t\tIND_7_31 = toInteger(byName('IND_7_31')),\n\t\tIND_7_32 = toInteger(byName('IND_7_32')),\n\t\tIND_7_33 = toInteger(byName('IND_7_33')),\n\t\tIND_7_34 = toInteger(byName('IND_7_34')),\n\t\tIND_7_35 = toInteger(byName('IND_7_35')),\n\t\tIND_7_36 = toInteger(byName('IND_7_36')),\n\t\tIND_7_41 = toInteger(byName('IND_7_41')),\n\t\tIND_7_42 = toInteger(byName('IND_7_42')),\n\t\tIND_7_43 = toInteger(byName('IND_7_43')),\n\t\tIND_7_44 = toInteger(byName('IND_7_44')),\n\t\tIND_7_45 = toInteger(byName('IND_7_45')),\n\t\tIND_7_46 = toInteger(byName('IND_7_46')),\n\t\tIND_7_51 = toInteger(byName('IND_7_51')),\n\t\tIND_7_52 = toInteger(byName('IND_7_52')),\n\t\tIND_7_53 = toInteger(byName('IND_7_53')),\n\t\tIND_7_54 = toInteger(byName('IND_7_54')),\n\t\tIND_7_55 = toInteger(byName('IND_7_55')),\n\t\tIND_7_56 = toInteger(byName('IND_7_56')),\n\t\tIND_7_61 = toInteger(byName('IND_7_61')),\n\t\tIND_7_62 = toInteger(byName('IND_7_62')),\n\t\tIND_7_63 = toInteger(byName('IND_7_63')),\n\t\tIND_7_64 = toInteger(byName('IND_7_64')),\n\t\tIND_7_65 = toInteger(byName('IND_7_65')),\n\t\tIND_7_66 = toInteger(byName('IND_7_66')),\n\t\tIND_8_1311 = toInteger(byName('IND_8_1311')),\n\t\tIND_8_1312 = toInteger(byName('IND_8_1312')),\n\t\tIND_8_2311 = toInteger(byName('IND_8_2311')),\n\t\tIND_8_2312 = toInteger(byName('IND_8_2312')),\n\t\tIND_3_81_ANT = toInteger(byName('IND_3_81_ANT')),\n\t\tIND_3_82_ANT = toInteger(byName('IND_3_82_ANT')),\n\t\tIND_3_83_ANT = toInteger(byName('IND_3_83_ANT')),\n\t\tIND_3_84_ANT = toInteger(byName('IND_3_84_ANT')),\n\t\tIND_3_85_ANT = toInteger(byName('IND_3_85_ANT')),\n\t\tIND_3_86_ANT = toInteger(byName('IND_3_86_ANT')),\n\t\tIND_3_87_ANT = toInteger(byName('IND_3_87_ANT')),\n\t\tIND_3_88_ANT = toInteger(byName('IND_3_88_ANT')),\n\t\tIND_3_89_ANT = toInteger(byName('IND_3_89_ANT')),\n\t\tIND_3_810_ANT = toInteger(byName('IND_3_810_ANT')),\n\t\tIND_3_8011_ANT = toInteger(byName('IND_3_8011_ANT')),\n\t\tIND_3_8012_ANT = toInteger(byName('IND_3_8012_ANT')),\n\t\tIND_3_8013_ANT = toInteger(byName('IND_3_8013_ANT')),\n\t\tIND_3_8014_ANT = toInteger(byName('IND_3_8014_ANT')),\n\t\tIND_3_8015_ANT = toInteger(byName('IND_3_8015_ANT')),\n\t\tIND_6_11_ANT = toInteger(byName('IND_6_11_ANT')),\n\t\tIND_6_12_ANT = toInteger(byName('IND_6_12_ANT')),\n\t\tIND_6_13_ANT = toInteger(byName('IND_6_13_ANT')),\n\t\tIND_6_14_ANT = toInteger(byName('IND_6_14_ANT')),\n\t\tIND_6_15_ANT = toInteger(byName('IND_6_15_ANT')),\n\t\tIND_6_16_ANT = toInteger(byName('IND_6_16_ANT')),\n\t\tIND_14_11_ANT = toInteger(byName('IND_14_11_ANT')),\n\t\tIND_14_12_ANT = toInteger(byName('IND_14_12_ANT')),\n\t\tIND_14_13_ANT = toInteger(byName('IND_14_13_ANT')),\n\t\tIND_14_14_ANT = toInteger(byName('IND_14_14_ANT')),\n\t\tIND_14_15_ANT = toInteger(byName('IND_14_15_ANT')),\n\t\tIND_14_16_ANT = toInteger(byName('IND_14_16_ANT')),\n\t\tIND_12_112_ANT = toInteger(byName('IND_12_112_ANT')),\n\t\tIND_12_113_ANT = toInteger(byName('IND_12_113_ANT')),\n\t\tIND_12_115_ANT = toInteger(byName('IND_12_115_ANT')),\n\t\tIND_12_117_ANT = toInteger(byName('IND_12_117_ANT')),\n\t\tIND_12_118_ANT = toInteger(byName('IND_12_118_ANT')),\n\t\tIND_12_119_ANT = toInteger(byName('IND_12_119_ANT')),\n\t\tIND_12_1110_ANT = toInteger(byName('IND_12_1110_ANT')),\n\t\tIND_12_116_ANT = toInteger(byName('IND_12_116_ANT')),\n\t\tIND_12_11012_ANT = toInteger(byName('IND_12_11012_ANT')),\n\t\tIND_12_11013_ANT = toInteger(byName('IND_12_11013_ANT')),\n\t\tIND_12_121_ANT = toInteger(byName('IND_12_121_ANT')),\n\t\tIND_12_122_ANT = toInteger(byName('IND_12_122_ANT')),\n\t\tIND_12_123_ANT = toInteger(byName('IND_12_123_ANT')),\n\t\tIND_12_124_ANT = toInteger(byName('IND_12_124_ANT')),\n\t\tIND_12_125_ANT = toInteger(byName('IND_12_125_ANT')),\n\t\tIND_12_126_ANT = toInteger(byName('IND_12_126_ANT')),\n\t\tIND_12_127_ANT = toInteger(byName('IND_12_127_ANT')),\n\t\tIND_12_128_ANT = toInteger(byName('IND_12_128_ANT')),\n\t\tIND_12_129_ANT = toInteger(byName('IND_12_129_ANT')),\n\t\tIND_12_1210_ANT = toInteger(byName('IND_12_1210_ANT')),\n\t\tIND_12_12011_ANT = toInteger(byName('IND_12_12011_ANT')),\n\t\tIND_12_12012_ANT = toInteger(byName('IND_12_12012_ANT')),\n\t\tIND_18_1 = toInteger(byName('IND_18_1')),\n\t\tIND_18_2 = toInteger(byName('IND_18_2')),\n\t\tIND_18_3 = toInteger(byName('IND_18_3')),\n\t\tIND_18_4 = toInteger(byName('IND_18_4')),\n\t\tIND_18_5 = toInteger(byName('IND_18_5')),\n\t\tIND_18_6 = toInteger(byName('IND_18_6')),\n\t\tIND_18_7 = toInteger(byName('IND_18_7')),\n\t\tIND_18_8 = toInteger(byName('IND_18_8')),\n\t\tIND_18_9 = toInteger(byName('IND_18_9')),\n\t\tIND_18_10 = toInteger(byName('IND_18_10'))) ~> ColumnasIndBase\nQuitarIndAnt unpivot(output(\n\t\tCODI_INDICADOR as string,\n\t\tIND_VALOR as integer\n\t),\n\tungroupBy(CODI_BIBLIOTECA),\n\tlateral: true,\n\tignoreNullPivots: false) ~> Unpivot\nColumnasIndBase derive(IND_3_8 = IND_3_81+IND_3_82+IND_3_83+IND_3_84+IND_3_85+IND_3_86+IND_3_87+IND_3_88+IND_3_89+IND_3_810+IND_3_8011+IND_3_8012+IND_3_8013+IND_3_8014+IND_3_8015,\n\t\tIND_3_9 = IND_3_91+IND_3_92+IND_3_93+IND_3_94+IND_3_95+IND_3_96+IND_3_97+IND_3_98+IND_3_99+IND_3_910+IND_3_9011+IND_3_9012+IND_3_9013+IND_3_9014+IND_3_9015,\n\t\tIND_3_101 = IND_3_81_ANT - IND_3_81 + IND_3_91,\n\t\tIND_3_102 = IND_3_82_ANT - IND_3_82 + IND_3_92,\n\t\tIND_3_103 = IND_3_83_ANT - IND_3_83 + IND_3_93,\n\t\tIND_3_104 = IND_3_84_ANT - IND_3_84 + IND_3_94,\n\t\tIND_3_105 = IND_3_85_ANT - IND_3_85 + IND_3_95,\n\t\tIND_3_106 = IND_3_86_ANT - IND_3_86 + IND_3_96,\n\t\tIND_3_107 = IND_3_87_ANT - IND_3_87 + IND_3_97,\n\t\tIND_3_108 = IND_3_88_ANT - IND_3_88 + IND_3_98,\n\t\tIND_3_109 = IND_3_89_ANT - IND_3_89 + IND_3_99,\n\t\tIND_3_1010 = IND_3_810_ANT - IND_3_810 + IND_3_910,\n\t\tIND_3_10011 = IND_3_8011_ANT - IND_3_8011 + IND_3_9011,\n\t\tIND_3_10012 = IND_3_8012_ANT - IND_3_8012 + IND_3_9012,\n\t\tIND_3_10013 = IND_3_8013_ANT - IND_3_8013 + IND_3_9013,\n\t\tIND_3_10014 = IND_3_8014_ANT - IND_3_8014 + IND_3_9014,\n\t\tIND_3_10015 = IND_3_8015_ANT - IND_3_8015 + IND_3_9015,\n\t\tIND_6_1 = IND_6_11+IND_6_12+IND_6_13+IND_6_14+IND_6_15+IND_6_16,\n\t\tIND_6_2 = IND_6_21+IND_6_22+IND_6_23+IND_6_24+IND_6_25+IND_6_26,\n\t\tIND_6_31 = IND_6_11_ANT - IND_6_11 + IND_6_21,\n\t\tIND_6_32 = IND_6_12_ANT - IND_6_12 + IND_6_22,\n\t\tIND_6_33 = IND_6_13_ANT - IND_6_13 + IND_6_23,\n\t\tIND_6_34 = IND_6_14_ANT - IND_6_14 + IND_6_24,\n\t\tIND_6_35 = IND_6_15_ANT - IND_6_15 + IND_6_25,\n\t\tIND_6_36 = IND_6_16_ANT - IND_6_16 + IND_6_26,\n\t\tIND_12_11 = IND_12_112+IND_12_113+IND_12_115+IND_12_116+IND_12_117+IND_12_118+IND_12_119+IND_12_1110+IND_12_11012+IND_12_11013,\n\t\tIND_12_12 = IND_12_121+IND_12_122+IND_12_123+IND_12_124+IND_12_125+IND_12_126+IND_12_127+IND_12_128+IND_12_129+IND_12_1210+IND_12_12011+IND_12_12012,\n\t\tIND_12_21 = IND_12_212+IND_12_213+IND_12_215+IND_12_216+IND_12_217+IND_12_218+IND_12_219+IND_12_2110+IND_12_21012+IND_12_21013,\n\t\tIND_12_22 = IND_12_221+IND_12_222+IND_12_223+IND_12_224+IND_12_225+IND_12_226+IND_12_227+IND_12_228+IND_12_229+IND_12_2210+IND_12_22011+IND_12_22012,\n\t\tIND_12_312 = IND_12_112_ANT -  IND_12_112 + IND_12_212,\n\t\tIND_12_313 = IND_12_113_ANT -  IND_12_113 + IND_12_213,\n\t\tIND_12_315 = IND_12_115_ANT -  IND_12_115 + IND_12_215,\n\t\tIND_12_316 = IND_12_116_ANT -  IND_12_116 + IND_12_216,\n\t\tIND_12_317 = IND_12_117_ANT -  IND_12_117 + IND_12_217,\n\t\tIND_12_318 = IND_12_118_ANT -  IND_12_118 + IND_12_218,\n\t\tIND_12_319 = IND_12_119_ANT -  IND_12_119 + IND_12_219,\n\t\tIND_12_3110 = IND_12_1110_ANT -  IND_12_1110 + IND_12_2110,\n\t\tIND_12_31012 = IND_12_11012_ANT -  IND_12_11012 + IND_12_21012,\n\t\tIND_12_31013 = IND_12_11013_ANT -  IND_12_11013 + IND_12_21013,\n\t\tIND_12_322 = IND_12_122_ANT - IND_12_122 + IND_12_222,\n\t\tIND_12_323 = IND_12_123_ANT - IND_12_123 + IND_12_223,\n\t\tIND_12_324 = IND_12_124_ANT - IND_12_124 + IND_12_224,\n\t\tIND_12_325 = IND_12_125_ANT - IND_12_125 + IND_12_225,\n\t\tIND_12_326 = IND_12_126_ANT - IND_12_126 + IND_12_226,\n\t\tIND_12_327 = IND_12_127_ANT - IND_12_127 + IND_12_227,\n\t\tIND_12_328 = IND_12_128_ANT - IND_12_128 + IND_12_228,\n\t\tIND_12_329 = IND_12_129_ANT - IND_12_129 + IND_12_229,\n\t\tIND_12_3210 = IND_12_1210_ANT - IND_12_1210 + IND_12_2210,\n\t\tIND_12_32011 = IND_12_12011_ANT - IND_12_12011 + IND_12_22011,\n\t\tIND_12_32012 = IND_12_12012_ANT - IND_12_12012 + IND_12_22012) ~> IndNuevos\nIndNuevos derive(IND_12_1 = IND_12_11+IND_12_12,\n\t\tIND_12_2 = IND_12_21+IND_12_22,\n\t\tIND_12_31 = IND_12_312+IND_12_313+IND_12_315+IND_12_316+IND_12_317+IND_12_318+IND_12_319+IND_12_3110+IND_12_31012+IND_12_31013,\n\t\tIND_12_32 = IND_12_322+IND_12_323+IND_12_324+IND_12_325+IND_12_326+IND_12_327+IND_12_328+IND_12_329+IND_12_3210+IND_12_32011+IND_12_32012,\n\t\tIND_3_10 = IND_3_101+IND_3_102+IND_3_103+IND_3_104+IND_3_105,\n\t\tIND_6_3 = IND_6_31+IND_6_32+IND_6_33+IND_6_34+IND_6_35+IND_6_36) ~> IndNuevos2\nFactIndicadors filter(addMonths(toDate(concat($Data_Carrega,'01'),'yyyyMMdd'),-1) == DATA_PERIODE) ~> FiltarFecha\nFiltarFecha filter(CODI_INDICADOR  == 'IND_3_81' || CODI_INDICADOR  == 'IND_3_82' || CODI_INDICADOR  == 'IND_3_83' || CODI_INDICADOR  == 'IND_3_84' || CODI_INDICADOR  == 'IND_3_85' || \nCODI_INDICADOR  == 'IND_3_86' || CODI_INDICADOR  == 'IND_3_87' || CODI_INDICADOR  == 'IND_3_88' || CODI_INDICADOR  == 'IND_3_89' || CODI_INDICADOR  == 'IND_3_810' || \nCODI_INDICADOR  == 'IND_3_8011' || CODI_INDICADOR  == 'IND_3_8012' || CODI_INDICADOR  == 'IND_3_8013' || CODI_INDICADOR  == 'IND_3_8014' || CODI_INDICADOR  == 'IND_3_8015' || \nCODI_INDICADOR  == 'IND_6_11' || CODI_INDICADOR  == 'IND_6_12' || CODI_INDICADOR  == 'IND_6_13' || CODI_INDICADOR  == 'IND_6_14' || CODI_INDICADOR  == 'IND_6_15' || \nCODI_INDICADOR  == 'IND_6_16' || CODI_INDICADOR  == 'IND_12_112' || CODI_INDICADOR  == 'IND_12_113' || CODI_INDICADOR  == 'IND_12_115' || CODI_INDICADOR  == 'IND_12_116' || \nCODI_INDICADOR  == 'IND_12_117' || CODI_INDICADOR  == 'IND_12_118' || CODI_INDICADOR  == 'IND_12_119' || CODI_INDICADOR  == 'IND_12_1110' || CODI_INDICADOR  == 'IND_12_11012' || \nCODI_INDICADOR  == 'IND_12_11013' || CODI_INDICADOR  == 'IND_12_121' || CODI_INDICADOR  == 'IND_12_122' || CODI_INDICADOR  == 'IND_12_123' || CODI_INDICADOR  == 'IND_12_124' || \nCODI_INDICADOR  == 'IND_12_125' || CODI_INDICADOR  == 'IND_12_126' || CODI_INDICADOR  == 'IND_12_127' || CODI_INDICADOR  == 'IND_12_128' || CODI_INDICADOR  == 'IND_12_129' || \nCODI_INDICADOR  == 'IND_12_1210' || CODI_INDICADOR  == 'IND_12_12011' || CODI_INDICADOR  == 'IND_12_12012' || CODI_INDICADOR  == 'IND_14_11' || CODI_INDICADOR  == 'IND_14_12' || \nCODI_INDICADOR  == 'IND_14_13' || CODI_INDICADOR  == 'IND_14_14' || CODI_INDICADOR  == 'IND_14_15' || CODI_INDICADOR  == 'IND_14_16') ~> FiltrarIndicadores\nFiltroNoNULLsANT derive(CODI_INDICADOR = CODI_INDICADOR+\"_ANT\") ~> IndMesAnterior\nFiltroNoNULLs, IndMesAnterior union(byName: true)~> Union\nIndNuevos2 derive(IND_12_3 = IND_12_31 + IND_12_32) ~> IndNuevos3\nIndNuevos3 select(mapColumn(\n\t\tCODI_BIBLIOTECA,\n\t\tIND_12_11012,\n\t\tIND_12_11013,\n\t\tIND_12_1110,\n\t\tIND_12_112,\n\t\tIND_12_113,\n\t\tIND_12_115,\n\t\tIND_12_116,\n\t\tIND_12_117,\n\t\tIND_12_118,\n\t\tIND_12_119,\n\t\tIND_12_12011,\n\t\tIND_12_12012,\n\t\tIND_12_121,\n\t\tIND_12_1210,\n\t\tIND_12_122,\n\t\tIND_12_123,\n\t\tIND_12_124,\n\t\tIND_12_125,\n\t\tIND_12_126,\n\t\tIND_12_127,\n\t\tIND_12_128,\n\t\tIND_12_129,\n\t\tIND_12_21013,\n\t\tIND_12_212,\n\t\tIND_12_213,\n\t\tIND_12_215,\n\t\tIND_12_216,\n\t\tIND_12_217,\n\t\tIND_12_218,\n\t\tIND_12_219,\n\t\tIND_12_2110,\n\t\tIND_12_21012,\n\t\tIND_12_22012,\n\t\tIND_12_221,\n\t\tIND_12_222,\n\t\tIND_12_223,\n\t\tIND_12_224,\n\t\tIND_12_225,\n\t\tIND_12_226,\n\t\tIND_12_227,\n\t\tIND_12_228,\n\t\tIND_12_229,\n\t\tIND_12_2210,\n\t\tIND_12_22011,\n\t\tIND_3_81,\n\t\tIND_3_82,\n\t\tIND_3_83,\n\t\tIND_3_84,\n\t\tIND_3_85,\n\t\tIND_3_86,\n\t\tIND_3_87,\n\t\tIND_3_88,\n\t\tIND_3_89,\n\t\tIND_3_810,\n\t\tIND_3_8011,\n\t\tIND_3_8012,\n\t\tIND_3_8013,\n\t\tIND_3_8014,\n\t\tIND_3_8015,\n\t\tIND_3_91,\n\t\tIND_3_92,\n\t\tIND_3_93,\n\t\tIND_3_94,\n\t\tIND_3_95,\n\t\tIND_3_96,\n\t\tIND_3_97,\n\t\tIND_3_98,\n\t\tIND_3_99,\n\t\tIND_3_910,\n\t\tIND_3_9011,\n\t\tIND_3_9012,\n\t\tIND_3_9013,\n\t\tIND_3_9014,\n\t\tIND_3_9015,\n\t\tIND_6_11,\n\t\tIND_6_12,\n\t\tIND_6_13,\n\t\tIND_6_14,\n\t\tIND_6_15,\n\t\tIND_6_16,\n\t\tIND_6_21,\n\t\tIND_6_22,\n\t\tIND_6_23,\n\t\tIND_6_24,\n\t\tIND_6_25,\n\t\tIND_6_26,\n\t\tIND_3_8,\n\t\tIND_3_9,\n\t\tIND_3_101,\n\t\tIND_3_102,\n\t\tIND_3_103,\n\t\tIND_3_104,\n\t\tIND_3_105,\n\t\tIND_3_106,\n\t\tIND_3_107,\n\t\tIND_3_108,\n\t\tIND_3_109,\n\t\tIND_3_1010,\n\t\tIND_3_10011,\n\t\tIND_3_10012,\n\t\tIND_3_10013,\n\t\tIND_3_10014,\n\t\tIND_3_10015,\n\t\tIND_6_1,\n\t\tIND_6_2,\n\t\tIND_6_31,\n\t\tIND_6_32,\n\t\tIND_6_33,\n\t\tIND_6_34,\n\t\tIND_6_35,\n\t\tIND_6_36,\n\t\tIND_12_11,\n\t\tIND_12_12,\n\t\tIND_12_21,\n\t\tIND_12_22,\n\t\tIND_12_312,\n\t\tIND_12_313,\n\t\tIND_12_315,\n\t\tIND_12_316,\n\t\tIND_12_317,\n\t\tIND_12_318,\n\t\tIND_12_319,\n\t\tIND_12_3110,\n\t\tIND_12_31012,\n\t\tIND_12_31013,\n\t\tIND_12_322,\n\t\tIND_12_323,\n\t\tIND_12_324,\n\t\tIND_12_325,\n\t\tIND_12_326,\n\t\tIND_12_327,\n\t\tIND_12_328,\n\t\tIND_12_329,\n\t\tIND_12_3210,\n\t\tIND_12_32011,\n\t\tIND_12_32012,\n\t\tIND_12_1,\n\t\tIND_12_2,\n\t\tIND_12_31,\n\t\tIND_12_32,\n\t\tIND_3_10,\n\t\tIND_6_3,\n\t\tIND_12_3\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> QuitarIndAnt\nODS2FactIndicadorsBase filter(isNull(IND_VALOR)) ~> FiltroNULLs\nODS2FactIndicadorsBase filter(!isNull(IND_VALOR)) ~> FiltroNoNULLs\nFiltrarIndicadores filter(!isNull(IND_VALOR)) ~> FiltroNoNULLsANT\nDataInsercio sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tCODI_BIBLIOTECA as string,\n\t\tCODI_INDICADOR as string,\n\t\tIND_VALOR as integer,\n\t\tDATA_INSERCIO as date,\n\t\tDATA_PERIODE as date\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> ODS3FactIndicadors"
		}
	}
}