{
	"name": "DF_DIBICA_A_DIM_BIBLIOTEQUES",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DM_BEG_DIM_DIBICA_BIBLIOTEQUES",
						"type": "DatasetReference"
					},
					"name": "DimDIBICA"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DM_BEG_DIM_BIBLIOTEQUES",
						"type": "DatasetReference"
					},
					"name": "DimBiblioteques"
				}
			],
			"transformations": [
				{
					"name": "Select"
				},
				{
					"name": "CatalegBEG"
				}
			],
			"scriptLines": [
				"source(output(",
				"          ID_BIBLIOTECA as integer,",
				"          ID_USUARI as integer,",
				"          CODI_BIBLIOTECA as string,",
				"          ID_TIPUS as integer,",
				"          ID_MODUL as integer,",
				"          CODI_NIDEN as string,",
				"          ID_ESTAT as integer,",
				"          DESC_BIBLIOTECA as string,",
				"          DATA_ALTA_BIBLIO as timestamp,",
				"          DATA_BAIXA_BIBLIO as timestamp,",
				"          ID_TIPUS_VIA as integer,",
				"          DESC_VIA as string,",
				"          NUM_VIA as string,",
				"          INE_MUNICIPI as string,",
				"          ID_DISTRICTE as integer,",
				"          CP as string,",
				"          UTMX as double,",
				"          UTMY as double,",
				"          NUM_LONGITUD as double,",
				"          NUM_LATITUD as double,",
				"          NUM_TELEFON as string,",
				"          NUM_EXTENSIO as string,",
				"          NUM_FAX as string,",
				"          DESC_EMAIL as string,",
				"          DESC_WEB as string,",
				"          FLAG_BEG as boolean,",
				"          FLAG_SLPC as boolean,",
				"          ID_MAPA as integer,",
				"          ID_CATEGORIA as integer,",
				"          ID_TITULARITAT as integer,",
				"          ID_FORMA_ACCES as integer,",
				"          ES_CATALEG_COLECTIU_CCLP as boolean,",
				"          WEB_CATALEG_COLECTIU_CCLP as string,",
				"          ES_CATALEG_COLECTIU_DIP_BCN as boolean,",
				"          WEB_CATALEG_COLECTIU_DIP_BCN as string,",
				"          ES_CATALEG_COLECTIU_CCUC as boolean,",
				"          WEB_CATALEG_COLECTIU_CCUC as string,",
				"          ES_CATALEG_COLECTIU_BEG as boolean,",
				"          WEB_CATALEG_COLECTIU_BEG as string,",
				"          ES_CATALEG_COLECTIU_ALTRES as boolean,",
				"          WEB_CATALEG_COLECTIU_ALTRES as string,",
				"          ID_DIRECTOR_TRACTAMENT as integer,",
				"          DESC_DIRECTOR_NOMB as string,",
				"          DESC_DIRECTOR_PRIMER_COGNOM as string,",
				"          DESC_DIRECTOR_SEGON_COGNOM as string,",
				"          FLAG_ADAPTADA as boolean,",
				"          DESC_OBSERVACIONS as string,",
				"          OBS_ITINERARIS as string,",
				"          DATA_ALTA as timestamp,",
				"          ID_USUARI_ALTA as integer,",
				"          DATA_MODIF as timestamp,",
				"          ID_USUARI_MODIF as integer,",
				"          DATA_BAIXA as timestamp,",
				"          ID_USUARI_BAIXA as integer,",
				"          ID_ADSCRIPCIO as integer,",
				"          ID_CATEGORIA_ESP as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DimDIBICA",
				"CatalegBEG select(mapColumn(",
				"          ID_BIBLIOTECA,",
				"          ID_USUARI,",
				"          CODI_BIBLIOTECA,",
				"          ID_TIPUS,",
				"          ID_MODUL,",
				"          CODI_NIDEN,",
				"          ID_ESTAT,",
				"          DESC_BIBLIOTECA,",
				"          DATA_ALTA_BIBLIO,",
				"          DATA_BAIXA_BIBLIO,",
				"          ID_TIPUS_VIA,",
				"          DESC_VIA,",
				"          NUM_VIA,",
				"          INE_MUNICIPI,",
				"          ID_DISTRICTE,",
				"          CP,",
				"          UTMX,",
				"          UTMY,",
				"          NUM_LONGITUD,",
				"          NUM_LATITUD,",
				"          NUM_TELEFON,",
				"          NUM_EXTENSIO,",
				"          NUM_FAX,",
				"          DESC_EMAIL,",
				"          DESC_WEB,",
				"          FLAG_BEG,",
				"          FLAG_SLPC,",
				"          ID_MAPA,",
				"          ID_CATEGORIA,",
				"          ID_TITULARITAT,",
				"          ID_FORMA_ACCES,",
				"          ES_CATALEG_COLECTIU_CCLP,",
				"          WEB_CATALEG_COLECTIU_CCLP,",
				"          ES_CATALEG_COLECTIU_DIP_BCN,",
				"          WEB_CATALEG_COLECTIU_DIP_BCN,",
				"          ES_CATALEG_COLECTIU_CCUC,",
				"          WEB_CATALEG_COLECTIU_CCUC,",
				"          ES_CATALEG_COLECTIU_BEG,",
				"          WEB_CATALEG_COLECTIU_BEG,",
				"          ES_CATALEG_COLECTIU_ALTRES,",
				"          WEB_CATALEG_COLECTIU_ALTRES,",
				"          ID_DIRECTOR_TRACTAMENT,",
				"          DESC_DIRECTOR_NOMB,",
				"          DESC_DIRECTOR_PRIMER_COGNOM,",
				"          DESC_DIRECTOR_SEGON_COGNOM,",
				"          FLAG_ADAPTADA,",
				"          DESC_OBSERVACIONS,",
				"          OBS_ITINERARIS,",
				"          DATA_ALTA,",
				"          ID_USUARI_ALTA,",
				"          DATA_MODIF,",
				"          ID_USUARI_MODIF,",
				"          DATA_BAIXA,",
				"          ID_USUARI_BAIXA,",
				"          ID_ADSCRIPCIO,",
				"          ID_CATEGORIA_ESP",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> Select",
				"DimDIBICA filter(ES_CATALEG_COLECTIU_BEG) ~> CatalegBEG",
				"Select sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          ID_BIBLIOTECA as integer,",
				"          ID_AGENCY as string,",
				"          ID_USUARI as integer,",
				"          CODI_BIBLIOTECA as string,",
				"          ID_TIPUS as integer,",
				"          ID_MODUL as integer,",
				"          CODI_NIDEN as string,",
				"          ID_ESTAT as integer,",
				"          DESC_BIBLIOTECA as string,",
				"          DATA_ALTA_BIBLIO as timestamp,",
				"          DATA_BAIXA_BIBLIO as timestamp,",
				"          ID_TIPUS_VIA as integer,",
				"          DESC_VIA as string,",
				"          NUM_VIA as string,",
				"          INE_MUNICIPI as string,",
				"          ID_DISTRICTE as integer,",
				"          CP as string,",
				"          UTMX as double,",
				"          UTMY as double,",
				"          NUM_LONGITUD as double,",
				"          NUM_LATITUD as double,",
				"          NUM_TELEFON as string,",
				"          NUM_EXTENSIO as string,",
				"          NUM_FAX as string,",
				"          DESC_EMAIL as string,",
				"          DESC_WEB as string,",
				"          FLAG_BEG as boolean,",
				"          FLAG_SLPC as boolean,",
				"          ID_MAPA as integer,",
				"          ID_CATEGORIA as integer,",
				"          ID_TITULARITAT as integer,",
				"          ID_FORMA_ACCES as integer,",
				"          ES_CATALEG_COLECTIU_CCLP as boolean,",
				"          WEB_CATALEG_COLECTIU_CCLP as string,",
				"          ES_CATALEG_COLECTIU_DIP_BCN as boolean,",
				"          WEB_CATALEG_COLECTIU_DIP_BCN as string,",
				"          ES_CATALEG_COLECTIU_CCUC as boolean,",
				"          WEB_CATALEG_COLECTIU_CCUC as string,",
				"          ES_CATALEG_COLECTIU_BEG as boolean,",
				"          WEB_CATALEG_COLECTIU_BEG as string,",
				"          ES_CATALEG_COLECTIU_ALTRES as boolean,",
				"          WEB_CATALEG_COLECTIU_ALTRES as string,",
				"          ID_DIRECTOR_TRACTAMENT as integer,",
				"          DESC_DIRECTOR_NOMB as string,",
				"          DESC_DIRECTOR_PRIMER_COGNOM as string,",
				"          DESC_DIRECTOR_SEGON_COGNOM as string,",
				"          FLAG_ADAPTADA as boolean,",
				"          DESC_OBSERVACIONS as string,",
				"          OBS_ITINERARIS as string,",
				"          DATA_ALTA as timestamp,",
				"          ID_USUARI_ALTA as integer,",
				"          DATA_MODIF as timestamp,",
				"          ID_USUARI_MODIF as integer,",
				"          DATA_BAIXA as timestamp,",
				"          ID_USUARI_BAIXA as integer,",
				"          ID_ADSCRIPCIO as integer,",
				"          ID_CATEGORIA_ESP as integer",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          CODI_BIBLIOTECA,",
				"          CODI_NIDEN,",
				"          ESTAT = ID_ESTAT,",
				"          TIPUS = ID_TIPUS,",
				"          CATEGORIA_ESPECIALITZADA = ID_CATEGORIA,",
				"          DESC_BIBLIOTECA,",
				"          DATA_ALTA = DATA_ALTA_BIBLIO,",
				"          DATA_BAIXA,",
				"          ADAPTADA = FLAG_ADAPTADA,",
				"          FORMA_ACCESS = ID_FORMA_ACCES,",
				"          TITULARITAT = ID_TITULARITAT,",
				"          MUNICIPI = INE_MUNICIPI,",
				"          {C.P.} = CP,",
				"          UTMX,",
				"          UTMY,",
				"          {TELÃˆFON} = NUM_TELEFON,",
				"          EXT = NUM_EXTENSIO,",
				"          FAX = NUM_FAX,",
				"          WEB = DESC_WEB,",
				"          TRACTAMENT_DIRECT = ID_DIRECTOR_TRACTAMENT,",
				"          NOM_DIRECT = DESC_DIRECTOR_NOMB,",
				"          PRIMER_COGNOM = DESC_DIRECTOR_PRIMER_COGNOM,",
				"          SEGON_COGNOM = DESC_DIRECTOR_SEGON_COGNOM,",
				"          OBSERVACIONS = DESC_OBSERVACIONS",
				"     )) ~> DimBiblioteques"
			]
		}
	}
}