{
	"name": "DF_DIBICA_A_BIBLIOTEQUES_BEG",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DM_BEG_DIM_DIBICA_BIBLIOTEQUES",
						"type": "DatasetReference"
					},
					"name": "DimDIBICA"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DM_BEG_DIM_BIBLIOTEQUES",
						"type": "DatasetReference"
					},
					"name": "DimBiblioteques"
				}
			],
			"transformations": [
				{
					"name": "FiltroBibliotecasBeg"
				},
				{
					"name": "AlterRow"
				}
			],
			"scriptLines": [
				"source(output(",
				"          ID_BIBLIOTECA as integer,",
				"          ID_USUARI as integer,",
				"          CODI_BIBLIOTECA as string,",
				"          ID_TIPUS as integer,",
				"          ID_MODUL as integer,",
				"          CODI_NIDEN as string,",
				"          ID_ESTAT as integer,",
				"          DESC_BIBLIOTECA as string,",
				"          DATA_ALTA_BIBLIO as timestamp,",
				"          DATA_BAIXA_BIBLIO as timestamp,",
				"          ID_TIPUS_VIA as integer,",
				"          DESC_VIA as string,",
				"          NUM_VIA as string,",
				"          INE_MUNICIPI as string,",
				"          ID_DISTRICTE as integer,",
				"          CP as string,",
				"          UTMX as double,",
				"          UTMY as double,",
				"          NUM_LONGITUD as double,",
				"          NUM_LATITUD as double,",
				"          NUM_TELEFON as string,",
				"          NUM_EXTENSIO as string,",
				"          NUM_FAX as string,",
				"          DESC_EMAIL as string,",
				"          DESC_WEB as string,",
				"          FLAG_BEG as boolean,",
				"          FLAG_SLPC as boolean,",
				"          ID_MAPA as integer,",
				"          ID_CATEGORIA as integer,",
				"          ID_TITULARITAT as integer,",
				"          ID_FORMA_ACCES as integer,",
				"          ES_CATALEG_COLECTIU_CCLP as boolean,",
				"          WEB_CATALEG_COLECTIU_CCLP as string,",
				"          ES_CATALEG_COLECTIU_DIP_BCN as boolean,",
				"          WEB_CATALEG_COLECTIU_DIP_BCN as string,",
				"          ES_CATALEG_COLECTIU_CCUC as boolean,",
				"          WEB_CATALEG_COLECTIU_CCUC as string,",
				"          ES_CATALEG_COLECTIU_BEG as boolean,",
				"          WEB_CATALEG_COLECTIU_BEG as string,",
				"          ES_CATALEG_COLECTIU_ALTRES as boolean,",
				"          WEB_CATALEG_COLECTIU_ALTRES as string,",
				"          ID_DIRECTOR_TRACTAMENT as integer,",
				"          DESC_DIRECTOR_NOMB as string,",
				"          DESC_DIRECTOR_PRIMER_COGNOM as string,",
				"          DESC_DIRECTOR_SEGON_COGNOM as string,",
				"          FLAG_ADAPTADA as boolean,",
				"          DESC_OBSERVACIONS as string,",
				"          OBS_ITINERARIS as string,",
				"          DATA_ALTA as timestamp,",
				"          ID_USUARI_ALTA as integer,",
				"          DATA_MODIF as timestamp,",
				"          ID_USUARI_MODIF as integer,",
				"          DATA_BAIXA as timestamp,",
				"          ID_USUARI_BAIXA as integer,",
				"          ID_ADSCRIPCIO as integer,",
				"          ID_CATEGORIA_ESP as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DimDIBICA",
				"DimDIBICA filter(in([",
				"'E0018','E0076',",
				"  'E0090',",
				"'E0298',",
				"'E0308',",
				"'E0017',",
				"'E0408',",
				"'E0409',",
				"'E0410',",
				"'E0411',",
				"'E0105',",
				"'E0324',",
				"'E0091',",
				"'E0325',",
				"'E0021',",
				"'E0093',",
				"'E0086',",
				"'E0097',",
				"'E0089',",
				"'E0095',",
				"'E0003',",
				"'E0010',",
				"'E0096',",
				"'E0068',",
				"'E0037',",
				"'E0111',",
				"'E0048',",
				"'E0041',",
				"'E0027',",
				"'E0043',",
				"'E0065',",
				"'E0098',",
				"'E0032',",
				"'E0006',",
				"'E0085',",
				"'E0053',",
				"'E0297',",
				"'E0009',",
				"'E0007',",
				"'E0072',",
				"'E0326',",
				"'E0320',",
				"'E0063',",
				"'E0064',",
				"'E0092',",
				"'E0028',",
				"'E0288',",
				"'E0073',",
				"'E0075',",
				"'E0050',",
				"'E0407',",
				"'E0221',",
				"'E0314',",
				"'E0312',",
				"'E0294',",
				"'E0313',",
				"'E0309',",
				"'E0317',",
				"'E0311',",
				"'E0310',",
				"'E0318',",
				"'E0280',",
				"'E0055',",
				"'E0049',",
				"'E0413',",
				"'E0052',",
				"'E0323',",
				"'E0322',",
				"'E0415'],CODI_BIBLIOTECA)) ~> FiltroBibliotecasBeg",
				"FiltroBibliotecasBeg alterRow(upsertIf(1==1)) ~> AlterRow",
				"AlterRow sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          ID_BIBLIOTECA as integer,",
				"          ID_AGENCY as string,",
				"          ID_USUARI as integer,",
				"          CODI_BIBLIOTECA as string,",
				"          ID_TIPUS as integer,",
				"          ID_MODUL as integer,",
				"          CODI_NIDEN as string,",
				"          ID_ESTAT as integer,",
				"          DESC_BIBLIOTECA as string,",
				"          DATA_ALTA_BIBLIO as timestamp,",
				"          DATA_BAIXA_BIBLIO as timestamp,",
				"          ID_TIPUS_VIA as integer,",
				"          DESC_VIA as string,",
				"          NUM_VIA as string,",
				"          INE_MUNICIPI as string,",
				"          ID_DISTRICTE as integer,",
				"          CP as string,",
				"          UTMX as double,",
				"          UTMY as double,",
				"          NUM_LONGITUD as double,",
				"          NUM_LATITUD as double,",
				"          NUM_TELEFON as string,",
				"          NUM_EXTENSIO as string,",
				"          NUM_FAX as string,",
				"          DESC_EMAIL as string,",
				"          DESC_WEB as string,",
				"          FLAG_BEG as boolean,",
				"          FLAG_SLPC as boolean,",
				"          ID_MAPA as integer,",
				"          ID_CATEGORIA as integer,",
				"          ID_TITULARITAT as integer,",
				"          ID_FORMA_ACCES as integer,",
				"          ES_CATALEG_COLECTIU_CCLP as boolean,",
				"          WEB_CATALEG_COLECTIU_CCLP as string,",
				"          ES_CATALEG_COLECTIU_DIP_BCN as boolean,",
				"          WEB_CATALEG_COLECTIU_DIP_BCN as string,",
				"          ES_CATALEG_COLECTIU_CCUC as boolean,",
				"          WEB_CATALEG_COLECTIU_CCUC as string,",
				"          ES_CATALEG_COLECTIU_BEG as boolean,",
				"          WEB_CATALEG_COLECTIU_BEG as string,",
				"          ES_CATALEG_COLECTIU_ALTRES as boolean,",
				"          WEB_CATALEG_COLECTIU_ALTRES as string,",
				"          ID_DIRECTOR_TRACTAMENT as integer,",
				"          DESC_DIRECTOR_NOMB as string,",
				"          DESC_DIRECTOR_PRIMER_COGNOM as string,",
				"          DESC_DIRECTOR_SEGON_COGNOM as string,",
				"          FLAG_ADAPTADA as boolean,",
				"          DESC_OBSERVACIONS as string,",
				"          OBS_ITINERARIS as string,",
				"          DATA_ALTA as timestamp,",
				"          ID_USUARI_ALTA as integer,",
				"          DATA_MODIF as timestamp,",
				"          ID_USUARI_MODIF as integer,",
				"          DATA_BAIXA as timestamp,",
				"          ID_USUARI_BAIXA as integer,",
				"          ID_ADSCRIPCIO as integer,",
				"          ID_CATEGORIA_ESP as integer",
				"     ),",
				"     deletable:false,",
				"     insertable:false,",
				"     updateable:false,",
				"     upsertable:true,",
				"     keys:['CODI_BIBLIOTECA'],",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> DimBiblioteques"
			]
		}
	}
}