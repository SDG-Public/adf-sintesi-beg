{
	"name": "DF_NO_PERIODICS_A_DATA_ENTRY",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DM_BEG_FACT_INDICADORS",
						"type": "DatasetReference"
					},
					"name": "DMFactDataEntrySource"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DM_BEG_FACT_DATA_ENTRY",
						"type": "DatasetReference"
					},
					"name": "DMFactDataEntrySink"
				}
			],
			"transformations": [
				{
					"name": "FiltrarMes"
				}
			],
			"scriptLines": [
				"parameters{",
				"     Data_Carrega as string",
				"}",
				"source(output(",
				"          ID_AGENCY as string,",
				"          CODI_BIBLIOTECA as string,",
				"          CODI_INDICADOR as string,",
				"          IND_VALOR as integer,",
				"          DATA_INSERCIO as date,",
				"          DATA_PERIODE as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> DMFactDataEntrySource",
				"DMFactDataEntrySource filter(addMonths(toDate(concat($Data_Carrega,'01'),'yyyyMMdd'),-1) == DATA_PERIODE) ~> FiltrarMes",
				"FiltrarMes sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          CODI_BIBLIOTECA as string,",
				"          DATA_PERIODE as date,",
				"          IND_1_4 as double,",
				"          IND_2_1111 as double,",
				"          IND_2_1113 as double,",
				"          IND_2_1122 as double,",
				"          IND_2_113 as double,",
				"          IND_2_114 as double,",
				"          IND_2_115 as double,",
				"          IND_2_121 as double,",
				"          IND_2_122 as double,",
				"          IND_2_123 as double,",
				"          IND_2_2111 as double,",
				"          IND_2_2113 as double,",
				"          IND_2_2122 as double,",
				"          IND_2_213 as double,",
				"          IND_2_214 as double,",
				"          IND_2_215 as double,",
				"          IND_2_221 as double,",
				"          IND_2_222 as double,",
				"          IND_2_223 as double,",
				"          IND_2_4111 as double,",
				"          IND_2_4113 as double,",
				"          IND_2_4122 as double,",
				"          IND_2_413 as double,",
				"          IND_2_414 as double,",
				"          IND_2_415 as double,",
				"          IND_2_421 as double,",
				"          IND_2_422 as double,",
				"          IND_2_423 as double,",
				"          IND_2_5111 as double,",
				"          IND_2_5113 as double,",
				"          IND_2_5122 as double,",
				"          IND_2_513 as double,",
				"          IND_2_514 as double,",
				"          IND_2_515 as double,",
				"          IND_2_521 as double,",
				"          IND_2_522 as double,",
				"          IND_2_523 as double,",
				"          IND_2_71 as double,",
				"          IND_2_72 as double,",
				"          IND_2_73 as double,",
				"          IND_2_74 as double,",
				"          IND_4_111 as double,",
				"          IND_4_112 as double,",
				"          IND_4_122 as double,",
				"          IND_4_123 as double,",
				"          IND_4_21 as double,",
				"          IND_4_22 as double,",
				"          IND_4_31 as double,",
				"          IND_4_32 as double,",
				"          IND_5_1 as double,",
				"          IND_5_2 as double,",
				"          IND_5_3 as double,",
				"          IND_5_41 as double,",
				"          IND_5_42 as double,",
				"          IND_5_5 as double,",
				"          IND_5_6 as double,",
				"          IND_5_7 as double,",
				"          IND_5_8 as double,",
				"          IND_5_9 as double,",
				"          IND_6_4 as double,",
				"          IND_8_1311 as double,",
				"          IND_8_1312 as double,",
				"          IND_8_132 as double,",
				"          IND_8_1411 as double,",
				"          IND_8_1412 as double,",
				"          IND_8_142 as double,",
				"          IND_8_1511 as double,",
				"          IND_8_1512 as double,",
				"          IND_8_152 as double,",
				"          IND_8_2311 as double,",
				"          IND_8_2312 as double,",
				"          IND_8_232 as double,",
				"          IND_8_2411 as double,",
				"          IND_8_2412 as double,",
				"          IND_8_242 as double,",
				"          IND_8_2511 as double,",
				"          IND_8_2512 as double,",
				"          IND_8_252 as double,",
				"          IND_8_311 as double,",
				"          IND_8_312 as double,",
				"          IND_8_313 as double,",
				"          IND_8_321 as double,",
				"          IND_8_322 as double,",
				"          IND_8_323 as double,",
				"          IND_9_2 as double,",
				"          IND_9_011 as double,",
				"          IND_9_012 as double,",
				"          IND_9_013 as double,",
				"          IND_9_015 as double,",
				"          IND_9_016 as double,",
				"          IND_9_020 as double,",
				"          IND_9_0223 as double,",
				"          IND_9_0231 as double,",
				"          IND_9_0232 as double,",
				"          IND_9_0233 as double,",
				"          IND_9_02411 as double,",
				"          IND_9_02412 as double,",
				"          IND_9_02413 as double,",
				"          IND_9_02421 as double,",
				"          IND_9_02422 as double,",
				"          IND_9_02423 as double,",
				"          IND_9_025 as double,",
				"          IND_9_026 as double,",
				"          IND_10_11 as double,",
				"          IND_10_13 as double,",
				"          IND_10_14 as double,",
				"          IND_10_15 as double,",
				"          IND_10_1613 as double,",
				"          IND_10_1614 as double,",
				"          IND_10_1615 as double,",
				"          IND_10_162 as double,",
				"          IND_10_17 as double,",
				"          IND_10_18 as double,",
				"          IND_10_21 as double,",
				"          IND_10_24 as double,",
				"          IND_10_25 as double,",
				"          IND_10_2612 as double,",
				"          IND_10_2613 as double,",
				"          IND_10_2614 as double,",
				"          IND_10_2615 as double,",
				"          IND_10_262 as double,",
				"          IND_10_27 as double,",
				"          IND_10_28 as double,",
				"          IND_11_11 as double,",
				"          IND_11_12 as double,",
				"          IND_11_13 as double,",
				"          IND_11_14 as double,",
				"          IND_11_15 as double,",
				"          IND_11_51 as double,",
				"          IND_11_52 as double,",
				"          IND_11_53 as double,",
				"          IND_11_54 as double,",
				"          IND_11_55 as double,",
				"          IND_16_1 as double,",
				"          IND_16_2 as double,",
				"          IND_16_3 as double,",
				"          IND_16_51 as double,",
				"          IND_16_52 as double,",
				"          IND_16_53 as double,",
				"          IND_16_54 as double,",
				"          IND_16_61 as double,",
				"          IND_16_62 as double,",
				"          IND_16_63 as double,",
				"          IND_16_64 as double,",
				"          IND_16_7 as double,",
				"          IND_16_8 as double,",
				"          IND_17_1 as double,",
				"          IND_17_2 as double,",
				"          IND_17_3 as double,",
				"          IND_19_1 as double,",
				"          IND_19_2 as double,",
				"          IND_19_3 as double,",
				"          IND_19_4 as double,",
				"          IND_19_5 as double,",
				"          IND_20_1 as double,",
				"          IND_20_2 as double,",
				"          IND_20_3 as double,",
				"          IND_20_4 as double,",
				"          IND_20_5 as double,",
				"          IND_21_1 as double,",
				"          IND_21_2 as double,",
				"          IND_21_3 as double,",
				"          IND_21_4 as double,",
				"          IND_5_10 as double",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> DMFactDataEntrySink"
			]
		}
	}
}