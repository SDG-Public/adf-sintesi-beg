{
	"name": "DF_DM_BIBLIOTEQUES",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "STG_BEG_DIM_BIBLIOTEQUES_DIBICA",
						"type": "DatasetReference"
					},
					"name": "STGBiblioteques"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DM_BEG_DIM_DIBICA_BIBLIOTEQUES",
						"type": "DatasetReference"
					},
					"name": "DMBiblioteques"
				}
			],
			"transformations": [],
			"scriptLines": [
				"source(output(",
				"          id_biblioteca as integer,",
				"          id_usuari as integer,",
				"          codi as string,",
				"          id_tipus as integer,",
				"          id_modul as integer,",
				"          niden as string,",
				"          id_estat as integer,",
				"          denominacio as string,",
				"          data_alta_biblio as timestamp,",
				"          data_baixa_biblio as timestamp,",
				"          id_tipus_via as integer,",
				"          nom_via as string,",
				"          numero_via as string,",
				"          ine_municipi as string,",
				"          id_districte as integer,",
				"          cp as string,",
				"          utmx as double,",
				"          utmy as double,",
				"          longitud as double,",
				"          latitud as double,",
				"          telefon as string,",
				"          extensio as string,",
				"          fax as string,",
				"          email as string,",
				"          web as string,",
				"          beg as boolean,",
				"          slpc as boolean,",
				"          id_mapa as integer,",
				"          id_categoria as integer,",
				"          id_titularitat as integer,",
				"          finan_adm_central as decimal(18,2),",
				"          finan_generalitat as decimal(18,2),",
				"          finan_diputacio as decimal(18,2),",
				"          finan_con_comarcal as decimal(18,2),",
				"          finan_ajuntament as decimal(18,2),",
				"          finan_universitat as decimal(18,2),",
				"          finan_privada as decimal(18,2),",
				"          finan_altres as decimal(18,2),",
				"          id_forma_acces as integer,",
				"          es_cataleg_colectiu_cclp as boolean,",
				"          web_cataleg_colectiu_cclp as string,",
				"          es_cataleg_colectiu_dip_bcn as boolean,",
				"          web_cataleg_colectiu_dip_bcn as string,",
				"          es_cataleg_colectiu_ccuc as boolean,",
				"          web_cataleg_colectiu_ccuc as string,",
				"          es_cataleg_colectiu_beg as boolean,",
				"          web_cataleg_colectiu_beg as string,",
				"          es_cataleg_colectiu_altres as boolean,",
				"          web_cataleg_colectiu_altres as string,",
				"          id_director_tractament as integer,",
				"          director_nom as string,",
				"          director_primer_cognom as string,",
				"          director_segon_cognom as string,",
				"          adaptada as boolean,",
				"          observacions as string,",
				"          obs_itineraris as string,",
				"          data_alta as timestamp,",
				"          id_usuari_alta as integer,",
				"          data_modif as timestamp,",
				"          id_usuari_modif as integer,",
				"          data_baixa as timestamp,",
				"          id_usuari_baixa as integer,",
				"          id_adscripcio as integer,",
				"          id_categoria_esp as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> STGBiblioteques",
				"STGBiblioteques sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          ID_BIBLIOTECA as integer,",
				"          ID_USUARI as integer,",
				"          CODI_BIBLIOTECA as string,",
				"          ID_TIPUS as integer,",
				"          ID_MODUL as integer,",
				"          CODI_NIDEN as string,",
				"          ID_ESTAT as integer,",
				"          DESC_BIBLIOTECA as string,",
				"          DATA_ALTA_BIBLIO as timestamp,",
				"          DATA_BAIXA_BIBLIO as timestamp,",
				"          ID_TIPUS_VIA as integer,",
				"          DESC_VIA as string,",
				"          NUM_VIA as string,",
				"          INE_MUNICIPI as string,",
				"          ID_DISTRICTE as integer,",
				"          CP as string,",
				"          UTMX as double,",
				"          UTMY as double,",
				"          NUM_LONGITUD as double,",
				"          NUM_LATITUD as double,",
				"          NUM_TELEFON as string,",
				"          NUM_EXTENSIO as string,",
				"          NUM_FAX as string,",
				"          DESC_EMAIL as string,",
				"          DESC_WEB as string,",
				"          FLAG_BEG as boolean,",
				"          FLAG_SLPC as boolean,",
				"          ID_MAPA as integer,",
				"          ID_CATEGORIA as integer,",
				"          ID_TITULARITAT as integer,",
				"          ID_FORMA_ACCES as integer,",
				"          ES_CATALEG_COLECTIU_CCLP as boolean,",
				"          WEB_CATALEG_COLECTIU_CCLP as string,",
				"          ES_CATALEG_COLECTIU_DIP_BCN as boolean,",
				"          WEB_CATALEG_COLECTIU_DIP_BCN as string,",
				"          ES_CATALEG_COLECTIU_CCUC as boolean,",
				"          WEB_CATALEG_COLECTIU_CCUC as string,",
				"          ES_CATALEG_COLECTIU_BEG as boolean,",
				"          WEB_CATALEG_COLECTIU_BEG as string,",
				"          ES_CATALEG_COLECTIU_ALTRES as boolean,",
				"          WEB_CATALEG_COLECTIU_ALTRES as string,",
				"          ID_DIRECTOR_TRACTAMENT as integer,",
				"          DESC_DIRECTOR_NOMB as string,",
				"          DESC_DIRECTOR_PRIMER_COGNOM as string,",
				"          DESC_DIRECTOR_SEGON_COGNOM as string,",
				"          FLAG_ADAPTADA as boolean,",
				"          DESC_OBSERVACIONS as string,",
				"          OBS_ITINERARIS as string,",
				"          DATA_ALTA as timestamp,",
				"          ID_USUARI_ALTA as integer,",
				"          DATA_MODIF as timestamp,",
				"          ID_USUARI_MODIF as integer,",
				"          DATA_BAIXA as timestamp,",
				"          ID_USUARI_BAIXA as integer,",
				"          ID_ADSCRIPCIO as integer,",
				"          ID_CATEGORIA_ESP as integer",
				"     ),",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     truncate:true,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError',",
				"     mapColumn(",
				"          ID_BIBLIOTECA = id_biblioteca,",
				"          ID_USUARI = id_usuari,",
				"          CODI_BIBLIOTECA = codi,",
				"          ID_TIPUS = id_tipus,",
				"          ID_MODUL = id_modul,",
				"          CODI_NIDEN = niden,",
				"          ID_ESTAT = id_estat,",
				"          DESC_BIBLIOTECA = denominacio,",
				"          DATA_ALTA_BIBLIO = data_alta_biblio,",
				"          DATA_BAIXA_BIBLIO = data_baixa_biblio,",
				"          ID_TIPUS_VIA = id_tipus_via,",
				"          DESC_VIA = nom_via,",
				"          NUM_VIA = numero_via,",
				"          INE_MUNICIPI = ine_municipi,",
				"          ID_DISTRICTE = id_districte,",
				"          CP = cp,",
				"          UTMX = utmx,",
				"          UTMY = utmy,",
				"          NUM_LONGITUD = longitud,",
				"          NUM_LATITUD = latitud,",
				"          NUM_TELEFON = telefon,",
				"          NUM_EXTENSIO = extensio,",
				"          NUM_FAX = fax,",
				"          DESC_EMAIL = email,",
				"          DESC_WEB = web,",
				"          FLAG_BEG = beg,",
				"          FLAG_SLPC = slpc,",
				"          ID_MAPA = id_mapa,",
				"          ID_CATEGORIA = id_categoria,",
				"          ID_TITULARITAT = id_titularitat,",
				"          ID_FORMA_ACCES = id_forma_acces,",
				"          ES_CATALEG_COLECTIU_CCLP = es_cataleg_colectiu_cclp,",
				"          WEB_CATALEG_COLECTIU_CCLP = web_cataleg_colectiu_cclp,",
				"          ES_CATALEG_COLECTIU_DIP_BCN = es_cataleg_colectiu_dip_bcn,",
				"          WEB_CATALEG_COLECTIU_DIP_BCN = web_cataleg_colectiu_dip_bcn,",
				"          ES_CATALEG_COLECTIU_CCUC = es_cataleg_colectiu_ccuc,",
				"          WEB_CATALEG_COLECTIU_CCUC = web_cataleg_colectiu_ccuc,",
				"          ES_CATALEG_COLECTIU_BEG = es_cataleg_colectiu_beg,",
				"          WEB_CATALEG_COLECTIU_BEG = web_cataleg_colectiu_beg,",
				"          ES_CATALEG_COLECTIU_ALTRES = es_cataleg_colectiu_altres,",
				"          WEB_CATALEG_COLECTIU_ALTRES = web_cataleg_colectiu_altres,",
				"          ID_DIRECTOR_TRACTAMENT = id_director_tractament,",
				"          DESC_DIRECTOR_NOMB = director_nom,",
				"          DESC_DIRECTOR_PRIMER_COGNOM = director_primer_cognom,",
				"          DESC_DIRECTOR_SEGON_COGNOM = director_segon_cognom,",
				"          FLAG_ADAPTADA = adaptada,",
				"          DESC_OBSERVACIONS = observacions,",
				"          OBS_ITINERARIS = obs_itineraris,",
				"          DATA_ALTA = data_alta,",
				"          ID_USUARI_ALTA = id_usuari_alta,",
				"          DATA_MODIF = data_modif,",
				"          ID_USUARI_MODIF = id_usuari_modif,",
				"          DATA_BAIXA = data_baixa,",
				"          ID_USUARI_BAIXA = id_usuari_baixa,",
				"          ID_ADSCRIPCIO = id_adscripcio,",
				"          ID_CATEGORIA_ESP = id_categoria_esp",
				"     )) ~> DMBiblioteques"
			]
		}
	}
}